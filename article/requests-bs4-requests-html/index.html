<!DOCTYPE html>
<html lang="vi">

<head>
   <title> Requests + bs4 <= Requests-HTML  - The PyMiers</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="robots" content="" />
  <link rel="stylesheet" type="text/css" href="/theme/css/app.css">
<link rel="stylesheet" type="text/css" href="http://pp.pymi.vn/theme/css/pygment.css">
  <!--
  <link href="https://fonts.googleapis.com/css?family=Fira+Sans" rel="stylesheet">
  -->

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    <meta name="author" content="Pymiers" />
  <meta name="description" content="" />    <link href="http://pp.pymi.vn/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The PyMiers Full Atom Feed" />         
  <meta name="tags" content="requests-html" />
  <meta name="tags" content="bs4" />
  <meta name="tags" content="requests" />
  <meta name="tags" content="python" />
  <meta name="tags" content="crawl" />
</head>

<body>
  <main class="wrapper">
    <section class="container">
      <header class='column'>
        <h1 class='title'><a href="http://pp.pymi.vn/">The PyMiers</a></h1>
      </header>

      <div class="section">
        <div class="row navbar">
          <div class="column nav-item "><a href="http://pp.pymi.vn/category/draft/">draft</a></div>
          <div class="column nav-item is-active"><a href="http://pp.pymi.vn/category/trang-chu/">Trang chủ</a></div>
           <div class="column nav-item "><a href="http://pp.pymi.vn/pages/about/">About</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/add/">Tạo bài viết</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/rss/">RSS</a></div>
          <div class="column nav-item"><a href="/archives">Archives</a></div>
        </div>
      </div>
    </section>

<section class="container">
  <header>
    <h2 class="entry-title">
      <a href="http://pp.pymi.vn/article/requests-bs4-requests-html/" rel="bookmark"
         title="Permalink to Requests + bs4 <= Requests-HTML">Requests + bs4 <= Requests-HTML</a></h2>  
  </header>
  <footer class='center'>
    <time class="published" datetime="2018-05-09T00:00:00+07:00"> 09/05/2018 </time>
    <address class="vcard author">By
                    <a class="url fn" href="http://pp.pymi.vn/author/tung491/">tung491</a>
 in <a href="http://pp.pymi.vn/category/trang-chu/">Trang chủ</a>
                </address>     <em>Tags</em>:     <a href="http://pp.pymi.vn/tag/requests-html/"><em>requests-html</em></a>,     <a href="http://pp.pymi.vn/tag/bs4/"><em>bs4</em></a>,     <a href="http://pp.pymi.vn/tag/requests/"><em>requests</em></a>,     <a href="http://pp.pymi.vn/tag/python/"><em>python</em></a>,     <a href="http://pp.pymi.vn/tag/crawl/"><em>crawl</em></a>    </footer>
  <br>
  <div class="entry-content">
    <h2>Giới thiệu</h2>
<p><a href="http://html.python-requests.org/">Requests-HTML</a> được viết bởi Kenneth Reitz - tác giả của <code>requests</code> nổi tiếng, với mục đích cao cả là thay thế combo huyền thoại (với pymier) requests + bs4.  Trên trang chủ, requests-html tự mô tả như sau:</p>
<blockquote>
<p>This library intends to make parsing HTML (e.g. scraping the web) as simple and intuitive as possible</p>
</blockquote>
<p>và đặc biệt chỉ hỗ trợ python3.</p>
<h2>Các tính năng nổi bật của requests-html</h2>
<ul>
<li>Hỗ trợ đầy đủ JavaScript</li>
<li>Hỗ trợ chọn thành phần của trang bằng CSS, Xpath</li>
<li>Tự động theo chuyển trang</li>
</ul>
<h2>Demo vài tính năng nổi bật</h2>
<p>Cách cài đặt và sử dụng cơ bản của requests-html đã được tác giả nói rất rõ ở trang chủ do đó mính sẽ không nói lại nữa.</p>
<h3>Render</h3>
<p>Nhặt một đoạn văn bản mà đã được render bởi JavaScript:</p>
<div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.familug.org/&#39;</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">r</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
<span class="p">[</span><span class="n">W</span><span class="p">:</span><span class="n">pyppeteer</span><span class="o">.</span><span class="n">chromium_downloader</span><span class="p">]</span> <span class="n">start</span> <span class="n">chromium</span> <span class="n">download</span><span class="o">.</span>
<span class="n">Download</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="n">few</span> <span class="n">minutes</span><span class="o">.</span>
<span class="p">[</span><span class="n">W</span><span class="p">:</span><span class="n">pyppeteer</span><span class="o">.</span><span class="n">chromium_downloader</span><span class="p">]</span> <span class="n">chromium</span> <span class="n">download</span> <span class="n">done</span><span class="o">.</span>
<span class="p">[</span><span class="n">W</span><span class="p">:</span><span class="n">pyppeteer</span><span class="o">.</span><span class="n">chromium_downloader</span><span class="p">]</span> <span class="n">chromium</span> <span class="n">extracted</span> <span class="n">to</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">dosontung007</span><span class="o">/.</span><span class="n">pyppeteer</span><span class="o">/</span><span class="n">local</span><span class="o">-</span><span class="n">chromium</span><span class="o">/</span><span class="mi">543305</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">r</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;UEFI vs BIOS - tạo USB boot cài Windows </span><span class="si">{something}</span><span class="s1"> từ Ubuntu&#39;</span><span class="p">)[</span><span class="s1">&#39;something&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="s1">&#39;10&#39;</span>
</code></pre></div>

<p>Khi bạn chạy render() lần đầu, method sẽ tải về <code>Chromium headless</code> về thư mục <code>$HOME</code>.</p>
<h3>XPath Selector</h3>
<p>Requests-html hỗ trợ Xpath query như Scrapy</p>
<div class="highlight"><pre><span></span><code><span class="ow">In</span><span class="w"> </span><span class="o">[</span><span class="n">25</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">html</span><span class="p">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//h3//a&#39;</span><span class="p">)</span><span class="w"></span>
<span class="k">Out</span><span class="o">[</span><span class="n">25</span><span class="o">]</span><span class="err">:</span><span class="w"></span>
<span class="o">[</span><span class="n">&lt;Element &#39;a&#39; href=&#39;http://www.familug.org/2018/04/uefi-vs-bios-tao-usb-boot-cai-windows.html&#39;&gt;,</span>
<span class="n"> &lt;Element &#39;a&#39; href=&#39;http://www.familug.org/2018/04/alsa-pulseaudio-jack-ubuntu.html&#39;&gt;,</span>
<span class="n"> &lt;Element &#39;a&#39; href=&#39;http://www.familug.org/2018/02/hello-2018.html&#39;&gt;,</span>
<span class="n"> &lt;Element &#39;a&#39; href=&#39;http://www.familug.org/2017/12/dung-git-diff-voi-patch.html&#39;&gt;,</span>
<span class="n"> &lt;Element &#39;a&#39; href=&#39;http://www.familug.org/2017/11/pgrep-e-grep-process.html&#39;&gt;,</span>
<span class="n"> &lt;Element &#39;a&#39; href=&#39;http://www.familug.org/2017/11/vuot-qua-gioi-han-1-deploy-key-cua.html&#39;&gt;</span><span class="o">]</span><span class="w"></span>
<span class="ow">In</span><span class="w"> </span><span class="o">[</span><span class="n">26</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">html</span><span class="p">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//h3//a/@href&#39;</span><span class="p">)</span><span class="w"></span>
<span class="k">Out</span><span class="o">[</span><span class="n">26</span><span class="o">]</span><span class="err">:</span><span class="w"></span>
<span class="o">[</span><span class="n">&#39;http://www.familug.org/2018/04/uefi-vs-bios-tao-usb-boot-cai-windows.html&#39;,</span>
<span class="n">&#39;http://www.familug.org/2018/04/alsa-pulseaudio-jack-ubuntu.html&#39;,</span>
<span class="n">&#39;http://www.familug.org/2018/02/hello-2018.html&#39;,</span>
<span class="n">&#39;http://www.familug.org/2017/12/dung-git-diff-voi-patch.html&#39;,</span>
<span class="n">&#39;http://www.familug.org/2017/11/pgrep-e-grep-process.html&#39;,</span>
<span class="n">&#39;http://www.familug.org/2017/11/vuot-qua-gioi-han-1-deploy-key-cua.html&#39;</span><span class="o">]</span><span class="w"></span>
</code></pre></div>

<h3>CSS Selector</h3>
<div class="highlight"><pre><span></span><code>In [26]: sel = &#39;#Blog1 &gt; div.blog-posts.hfeed &gt; div:nth-child(1) &gt; div &gt; div &gt; div &gt; h3&#39;

In [27]: r.html.find(sel, first=True)
Out[27]: &lt;Element &#39;h3&#39; class=(&#39;post-title&#39;, &#39;entry-title&#39;) itemprop=&#39;name&#39;&gt;

In [28]: r.html.find(sel, first=True).text
Out[28]: &#39;UEFI vs BIOS - tạo USB boot cài Windows 10 từ Ubuntu&#39;
</code></pre></div>

<p>CSS selector này có thể copy từ developer tool của trình duyệt web.</p>
<h2>Tổng kết</h2>
<p>Requests-html là 1 thư viện tiện lợi thay thế cho combo requests + bs4, dễ dàng chuyển lên scrapy nếu cần thực hiện dự án crawling lớn, chuyên nghiệp.</p>
<p>Chi tiết hơn xem tại: http://html.python-requests.org/.</p>
<p>HẾT.</p>
<p>TUNG491 at https://pymi.vn</p>
  </div>
  <!-- /.entry-content -->
</section>
<section class="container">
  <div class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'pymier';
      var disqus_identifier = 'article/requests-bs4-requests-html/';
      var disqus_url = 'http://pp.pymi.vn/article/requests-bs4-requests-html/';
      (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//pymier.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</section>

    <section class="container footer">
      <footer>
        <address>
        Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
        which takes great advantage of <a href="http://python.org">Python</a>.
        </address>
        <address>
          Học lập trình Python tại <a href="https://pymi.vn/">Pymi.vn</a>
        </address>
      </footer>
    </section>
  </main>

<script type="text/javascript">
var images = document.getElementsByTagName("img");
var i;

for(i = 0; i < images.length; i++) {
  images[i].className += " centered";
}
</script>
</body>

</html>