<!DOCTYPE html>
<html lang="vi">

<head>
   <title> Free variable  - The PyMiers</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="robots" content="" />
  <link rel="stylesheet" type="text/css" href="/theme/css/app.css">
<link rel="stylesheet" type="text/css" href="http://pp.pymi.vn/theme/css/pygment.css">
  <!--
  <link href="https://fonts.googleapis.com/css?family=Fira+Sans" rel="stylesheet">
  -->

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    <meta name="author" content="Pymiers" />
  <meta name="description" content="" />    <link href="http://pp.pymi.vn/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The PyMiers Full Atom Feed" />         
  <meta name="tags" content="python" />
</head>

<body>
  <main class="wrapper">
    <section class="container">
      <header class='column'>
        <h1 class='title'><a href="http://pp.pymi.vn/">The PyMiers</a></h1>
      </header>

      <div class="section">
        <div class="row navbar">
          <div class="column nav-item "><a href="http://pp.pymi.vn/category/draft/">draft</a></div>
          <div class="column nav-item is-active"><a href="http://pp.pymi.vn/category/trang-chu/">Trang ch·ªß</a></div>
           <div class="column nav-item "><a href="http://pp.pymi.vn/pages/about/">About</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/add/">T·∫°o b√†i vi·∫øt</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/rss/">RSS</a></div>
          <div class="column nav-item"><a href="/archives">Archives</a></div>
        </div>
      </div>
    </section>

<section class="container">
  <header>
    <h2 class="entry-title">
      <a href="http://pp.pymi.vn/article/free/" rel="bookmark"
         title="Permalink to Free variable">Free variable</a></h2>  
  </header>
  <footer class='center'>
    <time class="published" datetime="2021-06-07T00:00:00+07:00"> 07/06/2021 </time>
    <address class="vcard author">By
                    <a class="url fn" href="http://pp.pymi.vn/author/hvnsweeting/">hvnsweeting</a>
 in <a href="http://pp.pymi.vn/category/trang-chu/">Trang ch·ªß</a>
                </address>     <em>Tags</em>:     <a href="http://pp.pymi.vn/tag/python/"><em>python</em></a>    </footer>
  <br>
  <div class="entry-content">
    <p>Python c√≥ 2 lo·∫°i variable (bi·∫øn): local, global, v√† free (ƒë·∫øm t·ª´ 0, t·∫•t nhi√™n).</p>
<p><img alt="free" src="https://images.unsplash.com/photo-1546672117-f83291ce87a9?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=MnwyMzI1MzN8MHwxfHJhbmRvbXx8fHx8fHx8fDE2MjMwNzQxNTI&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=600"></p>
<h2>3 lo·∫°i variable trong Python</h2>
<h3>binding</h3>
<p><code>x = 42</code> trong Python ƒë·ªçc l√† bind name x t·ªõi object 42.
Tham kh·∫£o th√™m t·∫°i b√†i <a href="https://pymi.vn/blog/call-by/">Python call by g√¨?</a></p>
<h3>global variable</h3>
<p>ƒêo·∫°n code sau</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>


<p><code>x</code> vi·∫øt s√°t l·ªÅ, g·ªçi l√† global variable. Ch·∫°y ƒëo·∫°n code tr√™n s·∫Ω hi·ªán ra
exception:</p>
<div class="highlight"><pre><span></span><span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;x&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>


<p>do code d√πng x tr∆∞·ªõc khi x ƒë∆∞·ª£c bind t·ªõi object 42.</p>
<h3>local variable</h3>
<p>ƒêo·∫°n code ti·∫øp theo, ch·∫°y s·∫Ω th·∫•y g√¨? G·ª£i √Ω: kh√¥ng ph·∫£i NameError:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">foo</span><span class="p">()</span>
</pre></div>


<p><code>x = 42</code> n·∫±m trong 1 block (trong th√¢n function hay class), g·ªçi l√† local variable.
Trong 1 block, d√πng 1 variable/name tr∆∞·ªõc khi bind n√≥ (t·ª©c l√† c√≥ bind, nh∆∞ng
bind sau khi d√πng), exception s·∫Ω x·∫£y ra l√†</p>
<div class="highlight"><pre><span></span><span class="ne">UnboundLocalError</span><span class="p">:</span> <span class="n">local</span> <span class="n">variable</span> <span class="s1">&#39;x&#39;</span> <span class="n">referenced</span> <span class="n">before</span> <span class="n">assignment</span>
</pre></div>


<h3>free variable</h3>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">foo</span><span class="p">()</span>
</pre></div>


<p>X√≥a <code>x = 42</code> trong v√≠ d·ª• ph·∫ßn local, ta ch·∫°y ƒëo·∫°n code n√†y, l·∫°i th·∫•y NameError.</p>
<div class="highlight"><pre><span></span><span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;x&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>


<p>L·∫ßn n√†y kh√¥ng x·∫£y ra UnboundLocalError, do ƒëo·∫°n code kh√¥ng bind x = 42
trong th√¢n function (block). <code>x</code> ·ªü ƒë√¢y l√† m·ªôt free variable.</p>
<p>Free variable ho·∫°t ƒë·ªông theo c√°ch ... r·∫•t t·ª± do:</p>
<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">96</span>
<span class="n">foo</span><span class="p">()</span>
</pre></div>


<p>M√†n h√¨nh s·∫Ω hi·ªán ra <code>42</code> hay <code>96</code>?</p>
<p>Vi·ªác t√≠nh to√°n t√™n <code>x</code> c√≥ gi√° tr·ªã g√¨, ƒë∆∞·ª£c th·ª±c hi·ªán khi function <strong>CH·∫†Y</strong>.
Khi g·ªçi <code>foo()</code> ·ªü tr√™n, x ƒë√£ c√≥ gi√° tr·ªã l√† 96.</p>
<h2>Static analysis</h2>
<p>Vi·ªác d√πng c√°c c√¥ng c·ª• (ph·∫ßn m·ªÅm/ch∆∞∆°ng tr√¨nh) ƒë·ªÉ ph√¢n t√≠ch/t√¨m l·ªói code b·∫±ng
c√°ch ƒë·ªçc code (text) - m√† kh√¥ng c·∫ßn ch·∫°y code, g·ªçi l√† static analysis.
Trong Python ph·ªï bi·∫øn c√°c c√¥ng c·ª• nh∆∞ <code>pep8</code>, <code>flake8</code>, <code>pylint</code>, <a href="https://pp.pymi.vn/article/mypy/"><code>mypy</code> c≈©ng
c√≥ th·ªÉ t√≠nh lu√¥n</a>, hay c√°c t√≠nh nƒÉng
t√≠ch h·ª£p s·∫µn c·ªßa IDE nh∆∞ Pycharm.</p>
<p><code>flake8</code> c∆° b·∫£n gi·ªëng <code>pep8</code> (t√™n m·ªõi l√† <code>pycodestyle</code>), th√™m t√≠nh nƒÉng ph√°t
hi·ªán th∆∞ vi·ªán kh√¥ng d√πng t·ªõi/ hay bi·∫øn kh√¥ng t·ªìn t·∫°i.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">foo</span><span class="p">()</span>
</pre></div>


<p>khi ch·∫°y <code>flake8</code> v·ªõi file code, <code>flake8</code> s·∫Ω ph√°t hi·ªán ra th∆∞ vi·ªán
<code>math</code> ƒë∆∞·ª£c import nh∆∞ng kh√¥ng d√πng, t√™n <code>x</code> ch∆∞a ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a.</p>
<div class="highlight"><pre><span></span><span class="err">$</span> <span class="n">flake8</span> <span class="n">scope</span><span class="o">.</span><span class="n">py</span>
<span class="n">scope</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span> <span class="n">F401</span> <span class="s1">&#39;math&#39;</span> <span class="n">imported</span> <span class="n">but</span> <span class="n">unused</span>
<span class="n">scope</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span> <span class="n">F821</span> <span class="n">undefined</span> <span class="n">name</span> <span class="s1">&#39;x&#39;</span>
<span class="n">scope</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span> <span class="n">F841</span> <span class="n">local</span> <span class="n">variable</span> <span class="s1">&#39;x&#39;</span> <span class="ow">is</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">but</span> <span class="n">never</span> <span class="n">used</span>
</pre></div>


<p><code>flake8</code> r·∫•t h·ªØu √≠ch khi d·ªÖ d√†ng ph√°t hi·ªán c√°c l·ªói ƒë∆°n gi·∫£n nh∆∞ g√µ nh·∫ßm t√™n
bi·∫øn hay d√πng bi·∫øn kh√¥ng t·ªìn t·∫°i nh∆∞ tr√™n.
Nh∆∞ng khi <code>x</code> l√† free variable, kh√¥ng c√¥ng c·ª• n√†o c·ªßa Python c√≥ th·ªÉ ph√°t hi·ªán
ra l·ªói n√†y cho t·ªõi khi ch·∫°y m·ªõi th·∫•y exception:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">n_pymi_vn</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">n_pymi_vn</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>


<p>Do <code>x</code> l√† free variable, c√°c c√¥ng c·ª• ph·∫£i qu√©t h·∫øt c·∫£ file code ƒë·ªÉ t√¨m <code>x</code>,
v√† n√≥ t√¨m th·∫•y, n√™n tin r·∫±ng <code>x</code> c√≥ t·ªìn t·∫°i, nh∆∞ng ƒë√£ qu√° mu·ªôn r·ªìi.
M·ªôt v√≠ d·ª• v√¥ l√Ω h∆°n n·ªØa, ƒë·ªÉ th·∫•y s·ª± b·∫•t l·ª±c c·ªßa c√°c c√¥ng c·ª• static analysis:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">n_pymi_vn</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="k">if</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">n_pymi_vn</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>


<h2>H√†nh ƒë·ªông c·ªßa ch√∫ng ta</h2>
<p>H·∫°n ch·∫ø h·∫øt m·ª©c vi·ªác s·ª≠ d·ª•ng global variable, free variable, c·∫ßn bi·∫øn g√¨ th√¨
ƒë∆∞a argument v√†o function bi·∫øn ƒë√≥, code "s√°t t∆∞·ªùng" cho h·∫øt v√†o 1 function
main v√† g·ªçi main() n·∫øu c·∫ßn ch·∫°y.</p>
<h2>K·∫øt lu·∫≠n</h2>
<p>T√≠nh dynamic c·ªßa Python khi·∫øn c√°c c√¥ng c·ª• kh√≥ c√≥ th·ªÉ x·ª≠ l√Ω m·ªçi tr∆∞·ªùng h·ª£p,
c√¥ng c·ª• s·∫Ω ch·ªâ gi√∫p m·ªôt ph·∫ßn, ph·∫ßn c√≤n l·∫°i l√† s·ª± c·∫©n th·∫≠n c·ªßa l·∫≠p tr√¨nh vi√™n.</p>
<p>T·ª± do ph·∫£i chƒÉng c·∫ßn trong khu√¥n kh·ªï?</p>
<h2>Tham kh·∫£o</h2>
<ul>
<li><a href="https://www.familug.org/p/ung-ho.html">·ª¶ng h·ªô t√°c gi·∫£ üç∫</a></li>
<li><a href="https://docs.python.org/3/reference/executionmodel.html#interaction-with-dynamic-features">https://docs.python.org/3/reference/executionmodel.html#interaction-with-dynamic-features</a></li>
</ul>
  </div>
  <!-- /.entry-content -->
</section>
<section class="container">
  <div class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'pymier';
      var disqus_identifier = 'article/free/';
      var disqus_url = 'http://pp.pymi.vn/article/free/';
      (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//pymier.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</section>

    <section class="container footer">
      <footer>
        <address>
        Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
        which takes great advantage of <a href="http://python.org">Python</a>.
        </address>
        <address>
          H·ªçc l·∫≠p tr√¨nh Python t·∫°i <a href="https://pymi.vn/">Pymi.vn</a>
        </address>
      </footer>
    </section>
  </main>

<script type="text/javascript">
var images = document.getElementsByTagName("img");
var i;

for(i = 0; i < images.length; i++) {
  images[i].className += " centered";
}
</script>
</body>

</html>