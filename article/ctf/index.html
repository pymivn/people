<!DOCTYPE html>
<html lang="vi">

<head>
   <title> K√Ω s·ª± chi·∫øm c·ªù t·∫°i SNYK CTF 2021  - The PyMiers</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="robots" content="" />
  <link rel="stylesheet" type="text/css" href="/theme/css/app.css">
<link rel="stylesheet" type="text/css" href="http://pp.pymi.vn/theme/css/pygment.css">
  <!--
  <link href="https://fonts.googleapis.com/css?family=Fira+Sans" rel="stylesheet">
  -->

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    <meta name="author" content="Pymiers" />
  <meta name="description" content="" />    <link href="http://pp.pymi.vn/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The PyMiers Full Atom Feed" />         
  <meta name="tags" content="ctf" />
  <meta name="tags" content="hacking" />
  <meta name="tags" content="python" />
  <meta name="tags" content="docker" />
  <meta name="tags" content="regex" />
  <meta name="tags" content="golang" />
  <meta name="tags" content="stego" />
  <meta name="tags" content="javascript" />
</head>

<body>
  <main class="wrapper">
    <section class="container">
      <header class='column'>
        <h1 class='title'><a href="http://pp.pymi.vn/">The PyMiers</a></h1>
      </header>

      <div class="section">
        <div class="row navbar">
          <div class="column nav-item is-active"><a href="http://pp.pymi.vn/category/trang-chu/">Trang ch·ªß</a></div>
           <div class="column nav-item "><a href="http://pp.pymi.vn/pages/about/">About</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/add/">T·∫°o b√†i vi·∫øt</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/rss/">RSS</a></div>
          <div class="column nav-item"><a href="/archives">Archives</a></div>
        </div>
      </div>
    </section>

<section class="container">
  <header>
    <h2 class="entry-title">
      <a href="http://pp.pymi.vn/article/ctf/" rel="bookmark"
         title="Permalink to K√Ω s·ª± chi·∫øm c·ªù t·∫°i SNYK CTF 2021">K√Ω s·ª± chi·∫øm c·ªù t·∫°i SNYK CTF 2021</a></h2>  
  </header>
  <footer class='center'>
    <time class="published" datetime="2021-10-06T00:00:00+07:00"> 06/10/2021 </time>
    <address class="vcard author">By
                    <a class="url fn" href="http://pp.pymi.vn/author/hvnsweeting/">hvnsweeting</a>
                    <a class="url fn" href="http://pp.pymi.vn/author/khanhduy8/">khanhduy8</a>
                    <a class="url fn" href="http://pp.pymi.vn/author/cac-pymiers-va-khach-moi/">c√°c Pymiers v√† kh√°ch m·ªùi</a>
 in <a href="http://pp.pymi.vn/category/trang-chu/">Trang ch·ªß</a>
                </address>     <em>Tags</em>:     <a href="http://pp.pymi.vn/tag/ctf/"><em>ctf</em></a>,     <a href="http://pp.pymi.vn/tag/hacking/"><em>hacking</em></a>,     <a href="http://pp.pymi.vn/tag/python/"><em>python</em></a>,     <a href="http://pp.pymi.vn/tag/docker/"><em>docker</em></a>,     <a href="http://pp.pymi.vn/tag/regex/"><em>regex</em></a>,     <a href="http://pp.pymi.vn/tag/golang/"><em>golang</em></a>,     <a href="http://pp.pymi.vn/tag/stego/"><em>stego</em></a>,     <a href="http://pp.pymi.vn/tag/javascript/"><em>javascript</em></a>    </footer>
  <br>
  <div class="entry-content">
    <h2>CTF l√† g√¨?</h2>
<p>Capture the Flag (CTF) l√† m·ªôt tr√≤ ch∆°i ƒë∆∞·ª£c ∆∞a chu·ªông c·ªßa nh·ªØng ng∆∞·ªùi trong
ng√†nh b·∫£o m·∫≠t th√¥ng tin, th∆∞·ªùng t·ªï ch·ª©c theo d·∫°ng cu·ªôc thi v·ªõi nhi·ªÅu ƒë·ªôi
tham gia v√† c√≥ ƒë·ªôi d√†nh chi·∫øn th·∫Øng.</p>
<p>CTF c√≥ 3 d·∫°ng ph·ªï bi·∫øn:</p>
<ul>
<li>Jeopardy-style CTFs: ƒê·ªÅ thi th∆∞·ªùng g·ªìm nhi·ªÅu d·∫°ng b√†i thu·ªôc
c√°c lƒ©nh v·ª±c kh√°c nhau trong ng√†nh: cryptography, stego, binary analysis,
reverse engineering, mobile security, web hacking, OS, Linux...</li>
<li>attack-defence: m·ªói ƒë·ªôi ƒë∆∞·ª£c giao cho 1 h·ªá th·ªëng c√≥ c√°c l·ªói b·∫£o m·∫≠t, v√† 2 ƒë·ªôi
s·∫Ω v√° h·ªá th·ªëng c·ªßa m√¨nh ƒë·ªìng th·ªùi t·∫•n c√¥ng h·ªá th·ªëng c·ªßa ƒë·ªôi kh√°c.</li>
<li>mixed: ƒë·ªß d·∫°ng</li>
</ul>
<p>CTF v·ªõi ng∆∞·ªùi l√†m b·∫£o m·∫≠t gi·ªëng nh∆∞
<a href="https://www.leagueoflegends.com/en-us/">LOL</a> v·ªõi c√°c thanh ni√™n ch∆°i esport
v·∫≠y, c≈©ng c√≥ c√°c gi·∫£i ƒë·∫•u l·ªõn th·∫ø gi·ªõi.
Danh s√°ch c√°c gi·∫£i ƒë·∫•u l·ªõn c√≥ th·ªÉ xem tr√™n <a href="https://ctftime.org/ctfs">ctftime</a>,
n·ªïi ti·∫øng nh·∫•t c√≥ th·ªÉ k·ªÉ t·ªõi DEF CON CTF, ph·ªï bi·∫øn nh·∫•t c√≥ th·ªÉ g·ªçi t√™n Google CTF.</p>
<h2>SNYK CTF 2021</h2>
<p><a href="https://snyk.io/">SNYK.io</a> l√† m·ªôt c√¥ng ty l√†m v·ªÅ b·∫£o m·∫≠t, cung c·∫•p c√°c d·ªãch v·ª•
ph√°t hi·ªán l·ªói b·∫£o m·∫≠t t√≠ch h·ª£p v√†o h·ªá th·ªëng khi ph√°t tri·ªÉn ph·∫ßn m·ªÅm ·ªü c√°c doanh
nghi·ªáp v√† c·ªông ƒë·ªìng opensource. NƒÉm nay snyk t·ªï ch·ª©c CTF v√† team pymi nh·∫≠n ƒë∆∞·ª£c
<a href="https://mailchi.mp/pythonweekly/python-weekly-issue-519">l·ªùi qu·∫£ng c√°o tr√™n "PythonWeekly" email</a>, chi·∫øn th√¥i.
ƒê√¢y l√† l·∫ßn th·ª© 2 HVN tham gia m·ªôt gi·∫£i CTF, l·∫ßn ƒë·∫ßu l√† t·∫°i <a href="https://viblo.asia/p/code-war-2017-online-round-write-ups-part-1-aWj531Y1Z6m">Framgia
Code War
2017</a>,
b·∫µng c√°i 4 nƒÉm, kh√¥ng c√≥ kinh nghi·ªám g√¨ m·ªõi do c√¥ng
vi·ªác ch·∫≥ng li√™n quan t·ªõi h·∫Øc hi·∫øc g√¨.</p>
<p><strong>https://ctf.snyk.io/ Fetch the Flag at SnykCon 2021!</strong></p>
<p><strong>October 5, 9:00 am - 7:00 pm ET</strong></p>
<p>ƒëƒÉng k√Ω r·ªìi r·ªß r√™ team 5 ng∆∞·ªùi.</p>
<p>C√°ch t√≠nh ƒëi·ªÉm: 500 cho m·ªói b√†i, gi·∫£m d·∫ßn theo s·ªë l∆∞·ª£t gi·∫£i. T·ª©c gi·∫£i xong s·ªõm
th√¨ s·∫Ω ƒë∆∞·ª£c ƒëi·ªÉm cao, sau khi gi·∫£m d·∫ßn, ƒëi·ªÉm c√≥ th·ªÉ t·ªõi min l√† 50.</p>
<p>C√°c b√†i thi s·∫Ω c·∫ßn ƒëi t√¨m 1 ƒëo·∫°n flag d·∫°ng <code>SNYK{...}</code> r·ªìi ƒëi·ªÅn v√†o website
c·ªßa snyk.</p>
<h2>C·∫£nh b√°o</h2>
<p>Code trong c√°c cu·ªôc thi CTF th∆∞·ªùng ƒë∆∞·ª£c vi·∫øt ra nhanh nh·∫•t, n√™n th∆∞·ªùng kh√¥ng
theo c√°c chu·∫©n s·∫°ch g·ªçn ƒë·∫πp hay t·ªëi ∆∞u, n√≥ ƒë∆°n gi·∫£n l√† th·ª© b·∫°n vi·∫øt ra khi c√≥
s·ª©c √©p v·ªÅ m·∫∑t th·ªùi gian v√† m·ª•c ti√™u l√† k·∫øt qu·∫£.
Ch·ªâ n√™n d√πng ƒë·ªÉ tham kh·∫£o, tr√°nh d√πng l√†m vƒÉn m·∫´u.</p>
<h3>C·∫£nh b√°o 2</h3>
<p>B·∫°n ƒë·ªçc ch∆∞a quen ph·∫ßn n√†o c√≥ th·ªÉ b·ªè qua ph·∫ßn ƒë√≥, c√°c b√†i chia theo c√°c lƒ©nh
v·ª±c kh√°c nhau.</p>
<p>B√†i vi·∫øt b·ªüi HVN, c√°c ph·∫ßn do c√°c t√°c gi·∫£ kh√°c vi·∫øt c√≥ ghi r√µ trong t·ª´ng b√†i.</p>
<h2>C√°c b√†i ƒë√£ gi·∫£i trong th·ªùi gian thi ƒë·∫•u</h2>
<p><img alt="done" src="http://pp.pymi.vn/images/ctf_solved.jpg"></p>
<h2>Coding</h2>
<h3>CALC-UL8R</h3>
<p>ƒê·ªÅ cho 1 ƒë·ªãa ch·ªâ ƒë·ªÉ nc v√†o</p>
<div class="highlight"><pre><span></span><code>$ nc <span class="m">35</span>.211.207.36 <span class="m">8000</span>
  ____    _    _     ____      _   _ _     ___  ____
 / ___<span class="p">|</span>  / <span class="se">\ </span> <span class="p">|</span> <span class="p">|</span>   / ___<span class="p">|</span>    <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>   <span class="o">(</span> _ <span class="o">)</span><span class="p">|</span>  _ <span class="se">\</span>
<span class="p">|</span> <span class="p">|</span>     / _ <span class="se">\ </span><span class="p">|</span> <span class="p">|</span>  <span class="p">|</span> <span class="p">|</span>   _____<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>   / _ <span class="se">\|</span> <span class="p">|</span>_<span class="o">)</span> <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span>___ / ___ <span class="se">\|</span> <span class="o">||</span> <span class="o">||</span>_____<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span>__<span class="p">|</span> <span class="o">(</span>_<span class="o">)</span> <span class="p">|</span>  _ &lt;
 <span class="se">\_</span>___/_/   <span class="se">\_\_</span>____<span class="se">\_</span>___<span class="p">|</span>     <span class="se">\_</span>__/<span class="p">|</span>_____<span class="se">\_</span>__/<span class="p">|</span>_<span class="p">|</span> <span class="se">\_\</span>


<span class="m">31521</span> * <span class="m">2455</span> - <span class="m">29590</span> - o - <span class="m">40881</span> + <span class="nv">34681</span> <span class="o">=</span> <span class="m">77331423</span>
<span class="nv">o</span> <span class="o">=</span>
</code></pre></div>

<p>c·∫ßn t√≠nh gi√° tr·ªã c·ªßa bi·∫øn, trong v√≠ d·ª• n√†y l√† <code>o</code>, r·ªìi nh·∫≠p v√†o.
C·ª© nh·∫≠p xong, enter, ph√≠a server s·∫Ω tr·∫£ v·ªÅ 1 ph√©p t√≠nh kh√°c.</p>
<p>V·∫≠y c√≥ 2 vi·ªác c·∫ßn l√†m:</p>
<ul>
<li>k·∫øt n·ªëi ƒë·∫øn server ƒë·ªÉ nh·∫≠n ƒë·ªÅ v√† g·ª≠i k·∫øt qu·∫£: vi·ªác n√†y c√≥ th·ªÉ d√πng Python telnetlib</li>
<li>ƒë·ªçc bi·ªÉu th·ª©c v√† t√≠nh ra k·∫øt qu·∫£</li>
</ul>
<p>Do l·∫ßn ƒë·∫ßu d√πng <a href="https://docs.python.org/3/library/telnetlib.html#telnet-example"><code>telnetlib</code></a>, n√™n c≈©ng kh√° v·∫•t v·∫£ m·ªôt l√∫c m·ªõi t√¨m
ra c√°ch ƒë·ªçc d√πng <a href="https://pp.pymi.vn/article/10x/">regex</a>
thay v√¨ d√πng string.</p>
<ul>
<li><code>read_until("string")</code> s·∫Ω ƒë·ªçc ƒë·∫øn khi th·∫•y "string" th√¨ tr·∫£ n·ªôi dung v·ªÅ</li>
<li><code>expect(list, timeout=None)</code>  ƒë·ªçc ƒë·∫øn khi 1 trong c√°c regex  pattern match.</li>
</ul>
<p>Sau khi ƒë√£ g·ª≠i nh·∫≠n ƒë∆∞·ª£c, c·∫ßn vi·∫øt code gi·∫£i ph∆∞∆°ng tr√¨nh, ban ƒë·∫ßu m√¨nh c√≥ t·ª± vi·∫øt code ƒë·ªÉ gi·∫£i ph∆∞∆°ng tr√¨nh b·∫±ng c√°ch thay bi·∫øn trong ph∆∞∆°ng tr√¨nh (1 k√Ω t·ª±, d√πng regex) b·∫±ng s·ªë 0, r·ªìi chuy·ªÉn v·∫ø c√°c ph√©p t√≠nh c√≤n l·∫°i. C√°ch l√†m ƒë∆°n gi·∫£n n√†y ƒë√∫ng cho ƒë·∫øn khi n√≥ sai: bi·ªÉu th·ª©c c√≥ ph√©p nh√¢n. Nghƒ© t·ªõi gi·∫£i ph∆∞∆°ng tr√¨nh tr√™n Python l√† nghƒ© t·ªõi sympy, search <code>sympy solve equation</code> th·∫•y ngay</p>
<ul>
<li><a href="https://stackoverflow.com/a/30776918/807703">https://stackoverflow.com/a/30776918/807703</a></li>
</ul>
<p>s·ª≠a l·∫°i ƒë·ªÉ nh·∫≠n m·ªçi bi·∫øn, PS: ·ªü ƒë√¢y m√¨nh ko chƒÉm ch·ªâ vi·∫øt tay t·ª´ a ƒë·∫øn z m√† g√µ 1 d√≤ng Python l√† xong</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">string</span><span class="p">;</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">)</span>
<span class="s1">&#39;a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z&#39;</span>
</code></pre></div>

<p>Code gi·∫£i ph∆∞∆°ng tr√¨nh</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">solve</span>
<span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
<span class="kn">from</span> <span class="nn">sympy.parsing.sympy_parser</span> <span class="kn">import</span> <span class="n">parse_expr</span>

<span class="k">def</span> <span class="nf">solve_meThis</span><span class="p">(</span><span class="n">string_</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">lhs</span> <span class="o">=</span>  <span class="n">parse_expr</span><span class="p">(</span><span class="n">string_</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rhs</span> <span class="o">=</span>  <span class="n">parse_expr</span><span class="p">(</span><span class="n">string_</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">lhs</span><span class="o">-</span><span class="n">rhs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">solution</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;invalid equation&quot;</span><span class="p">)</span>


<span class="n">equation</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">valid_text</span> <span class="o">=</span> <span class="n">equation</span>

<span class="p">[</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">solve_meThis</span><span class="p">(</span><span class="n">valid_text</span><span class="p">)</span>
</code></pre></div>

<p>Th·ª±c hi·ªán g·ª≠i nh·∫≠n li√™n t·ª•c c√°c ph√©p t√≠nh cho ƒë·∫øn khi server tr·∫£ v·ªÅ k·∫øt qu·∫£:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">SNYK</span><span class="si">{37d779963c037715c02624b6963008f55e92d12e8714a15b7a905c1c997d1afc}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>

<p>File Jupyter Notebook d√πng gi·∫£i b√†i n√†y
<a href="https://gist.github.com/hvnsweeting/7e00e139912b9d65a1ec7c1913fdb513">https://gist.github.com/hvnsweeting/7e00e139912b9d65a1ec7c1913fdb513</a></p>
<h3>Random flag generator - python</h3>
<p>M·ªôt b√†i ƒë∆∞·ª£c tag th·∫ª <code>python</code>, cho 1 file code python v√† 1 file log:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">hashlib</span>

<span class="n">seed</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">rnd</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

    <span class="nb">hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SNYK</span><span class="se">{{</span><span class="si">{</span><span class="nb">hash</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;5bc&quot;</span> <span class="ow">in</span> <span class="nb">hash</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;./flag&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad random value: </span><span class="si">{</span><span class="n">rnd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Flag created üéâ&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">3719072557403058</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">3702330745519661</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">0634360689087381</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">2952684217196877</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">49843979869018884</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">7895773927381043</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">2917373566923527</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">9030776618431813</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">7181809628413409</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">28050872595896736</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">17458286936713008</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">2767390568969583</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">5492478684168797</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">2641653670084557</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">5156703392963877</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">32839693347899057</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">6998299885658202</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">5811672985185747</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">4644468325648108</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">49982517906634727</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">9333988943747559</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">7513893164652713</span><span class="w"></span>
<span class="nv">Bad</span><span class="w"> </span><span class="k">random</span><span class="w"> </span><span class="nv">value</span>:<span class="w"> </span><span class="mi">0</span>.<span class="mi">18638831058360805</span><span class="w"></span>
<span class="nv">Flag</span><span class="w"> </span><span class="nv">created</span><span class="w"> </span>üéâ<span class="w"></span>
</code></pre></div>

<p>ƒê·ªçc code th·∫•y ƒë·ªÉ t√¨m ƒë∆∞·ª£c flag, c·∫ßn t√¨m ra
gi√° tr·ªã <code>seed</code> m√† ng∆∞·ªùi ra ƒë·ªÅ ƒë√£ d√πng.
C√°c h·ªçc vi√™n <a href="https://pymi.vn">h·ªçc Python t·∫°i Pymi.vn</a> ƒë·ªÅu ƒë∆∞·ª£c h·ªçc: c√°c function trong <code>random</code> ch·ªâ l√† "g·ªâa ng·∫´u nhi√™n" v√† th·ª±c ch·∫•t l√† ch·∫°y thu·∫≠t to√°n sinh s·ªë ng·∫´u nhi√™n d·ª±a tr√™n gi√° tr·ªã <code>seed</code>. <code>seed</code> trong b√†i n√†y g·ª£i √Ω l√† UNIX timestamp, ch·∫°y t·ª´ 0 t·ªõi kho·∫£ng 1 t·ª∑ 6 (1633537375).
C√°ch t√¨m ƒë∆°n gi·∫£n l√† s·ª≠a l·∫°i code, ch·∫°y l·∫ßn l∆∞·ª£t v·ªõi t·ª´ng seed, so s√°nh ƒë·∫ßu ra (thay v√¨ print th√¨ cho v√†o 1 string) v·ªõi file log. N·∫øu gi·ªëng nhau t·ª©c ƒë√≥ l√† g√≠a tr·ªã seed c·∫ßn t√¨m.</p>
<p>V·∫•n ƒë·ªÅ ·ªü c√°ch l√†m n√†y, khi Python th·ª±c hi·ªán kho·∫£ng 16 tri·ªáu ph√©p +1 m·ªói gi√¢y (xem <a href="https://cpu.pymi.vn/">cpu.pymi.vn</a>), th√¨ ƒë·ªÉ t√≠nh 1 t·ª∑ 6 ph·∫£i m·∫•t √≠t nh·∫•t 100 gi√¢y.
M·ªói gi√° tr·ªã seed l·∫°i sinh nhi·ªÅu random value, th·ªùi gian s·∫Ω g·∫•p th√™m 20 - 30 l·∫ßn. V√† khi mang ch·∫°y th·∫≠t, m·ªói gi√¢y n√≥ t√≠nh kho·∫£ng ƒë∆∞·ª£c 5000-10000 seed. T·ª©c qu√° ch·∫≠m v√† c·∫ßn tƒÉng t·ªëc.
N√©m th√™m c√°c gi·∫£i ph√°p nh∆∞ d√πng thread/multiprocess c≈©ng kh√¥ng kh√° h∆°n l√† bao.
Sau 30 ph√∫t, 1 ti·∫øng kh√¥ng ra k√™t qu·∫£, v√† gi·∫£i xong 1 b√†i kh√°c trong th·ªùi gian ch·ªù n√†y, m√¨nh quay l·∫°i t·ªëi ∆∞u code.</p>
<p>Thay v√¨ t√≠nh h·∫øt output c·ªßa m·ªói seed, cho n√≥ d·ª´ng l·∫°i ngay n·∫øu d√≤ng log ƒë·∫ßu ti√™n kh√°c v·ªõi d√≤ng ƒë·∫ßu ti√™n trong log.txt.
Sau 1-2 ph√∫t ƒë√£ c√≥ k·∫øt qu·∫£.</p>
<p>Code: <a href="https://gist.github.com/hvnsweeting/619ecf04aa9b57bd6b44f3fcc57fe8c2">https://gist.github.com/hvnsweeting/619ecf04aa9b57bd6b44f3fcc57fe8c2</a></p>
<h3>Russian doll</h3>
<p>ƒê·ªÅ b√†i cho ·ªü d·∫°ng ƒë√£ m√£ h√≥a:</p>
<blockquote>
<p>Esp qwlr td DOKnGoIgKSsVvizaEAJmEgxiEShQKjjgyfeLhdutuIhObpZr IIEPL pyncjaepo. Alddhzco stye: iiii.</p>
</blockquote>
<p>v√† sau khi @pham <a href="https://planetcalc.com/1434/">d√πng tool</a> ƒë·ªÉ gi·∫£i m√£ <a href="https://www.familug.org/2014/12/programming-phe-rot13.html">ROT15</a> th√¨ thu ƒë∆∞·ª£c n·ªôi dung:</p>
<blockquote>
<p>The flag is SDZcVdXvZHhKkxopTPYbTvmxTHwFZyyvnutAwsjijXwDqeOg XXTEA encrypted. Password hint: xxxx.</p>
</blockquote>
<p>CTF th∆∞·ªùng l√† v·∫≠y, sau l·ªõp n√†y s·∫Ω qua l·ªõp kh√°c.
Gi·ªù ƒë·ªÉ √Ω l·∫°i t√™n b√†i, c≈©ng v·ªõi h√†m √Ω t∆∞∆°ng t·ª±, Russian doll Matryoshka, trong con n√†y l√† con kh√°c.</p>
<p><img alt="doll" src="https://images.unsplash.com/photo-1613981948475-6e2407d8b589?ixlib=rb-1.2.1&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;dl=didssph-PB80D_B4g7c-unsplash.jpg&amp;w=640"></p>
<p><center>
Photo by <a href="https://unsplash.com/@didsss?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Didssph</a> on <a href="https://unsplash.com/s/photos/russian-doll?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a>
</center></p>
<p>v·ªõi l∆∞·ª£ng ƒëi·ªÉm thu ƒë∆∞·ª£c cho b√†i n√†y l√† 490/500 l√∫c  October 6th, 2:44:17 AM, sau ~7 ti·∫øng, th√¨ ƒë√¢y r√µ l√† 1 b√†i kh√≥.
Ho·∫∑c n√≥ ti·∫øt l·ªô 1 ph·∫ßn v·ªÅ c√¥ng c·ª• c·ªßa ng∆∞·ªùi ch∆°i ƒë·ªÅu l√† Python, v√¨ sao h√£y ƒë·ªçc ti·∫øp...
Cho m·ªôt thu·∫≠t to√°n m√£ h√≥a cho tr∆∞·ªõc, v·ªõi key l√† 4 k√Ω t·ª±, h·∫≥n kh√¥ng kh√≥ khƒÉn g√¨ c√°c team c√≥ th·ªÉ t·∫£i ngay lib Python tr√™n m·∫°ng v·ªÅ v√† bruteforce v√†i ph√∫t l√† c√≥ ngay k·∫øt qu·∫£. ƒêen thay, 2 th∆∞ vi·ªán t√¨m th·∫•y ƒë·∫ßu ti√™n, ƒë·ªÅu c√≥ v·∫ª kh√¥ng d√πng ƒë∆∞·ª£c</p>
<ul>
<li><a href="https://pypi.org/project/xxtea/">https://pypi.org/project/xxtea/</a></li>
</ul>
<p>c√≥ 1 d√≤ng y√™u c·∫ßu <code># Key must be a 16-byte string.</code>
Trong khi b√†i n√†y key l√† 4 k√Ω t·ª±.</p>
<ul>
<li><a href="https://pypi.org/project/xxtea-py/">https://pypi.org/project/xxtea-py/</a></li>
</ul>
<p>m·ªôt c√°i lib kh√° o√°i oƒÉm khi c√†i th√¨ ok m√† d√πng th√¨ l·∫°i ƒë√≤i cffi, v√† h·∫ßu h·∫øt m·ªçi ng∆∞·ªùi d·ª´ng l·∫°i ·ªü ƒë√≥.</p>
<p>V·∫≠y ph·∫£i l√†m sao? k·∫øt qu·∫£ khi search c≈©ng tr·∫£ v·ªÅ nhi·ªÅu th∆∞ vi·ªán cho ng√¥n ng·ªØ kh√°c nh∆∞ C, C++, Golang... m√† ng·ªìi vi·∫øt C sau 10 nƒÉm kh√¥ng vi·∫øt th√¨ r·∫•t cƒÉng.
Nh∆∞ng cu·ªëi c√πng, Golang l·∫°i l√† gi·∫£i ph√°p, nh·ªù v√†i nƒÉm code Go ƒÉn ti·ªÅn, sau 5 ph√∫t, ten ten c√≥ lu√¥n k·∫øt qu·∫£:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span><span class="w"></span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;encoding/base64&quot;</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;fmt&quot;</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;log&quot;</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;strings&quot;</span><span class="w"></span>

<span class="w">    </span><span class="s">&quot;github.com/xxtea/xxtea-go/xxtea&quot;</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nx">encodedString</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;SDZcVdXvZHhKkxopTPYbTvmxTHwFZyyvnutAwsjijXwDqeOg&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nx">originalStringBytes</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">base64</span><span class="p">.</span><span class="nx">StdEncoding</span><span class="p">.</span><span class="nx">DecodeString</span><span class="p">(</span><span class="nx">encodedString</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nx">log</span><span class="p">.</span><span class="nx">Fatalf</span><span class="p">(</span><span class="s">&quot;Some error occured during base64 decode. Error %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="nx">key</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;1234567890&quot;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nx">keyNow</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">string</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">string</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">string</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">string</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="nx">decrypt_data</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">string</span><span class="p">(</span><span class="nx">xxtea</span><span class="p">.</span><span class="nx">Decrypt</span><span class="p">(</span><span class="nx">originalStringBytes</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">keyNow</span><span class="p">)))</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="nx">strings</span><span class="p">.</span><span class="nx">Contains</span><span class="p">(</span><span class="nx">decrypt_data</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SNYK&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;%s\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">decrypt_data</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p><a href="https://gist.github.com/hvnsweeting/b8d518fdd67b85e9bf9f6a16af6221af">Code</a></p>
<p>k·∫øt lu·∫≠n ·ªü ƒë√¢y l√† th√†nh th·∫°o th√™m m·ªôt ng√¥n ng·ªØ backup ph·ªï bi·∫øn nh∆∞
C/C++/Java/C#/Golang s·∫Ω r·∫•t h·ªØu √≠ch khi kh√¥ng d√πng ƒë∆∞·ª£c Python. N√≥i th√¨ d·ªÖ, ch·ª©
th√†nh th·∫°o 1 ng√¥n ng·ªØ ƒë·∫øn m·ª©c d√πng ƒë∆∞·ª£c l√∫c √°p l·ª±c th·ªùi gian kh√¥ng ph·∫£i chuy·ªán
ai c≈©ng c√≥ th·ªùi gian/ti·ªÅn c·ªßa ƒë·∫ßu t∆∞, gi·∫£i ph√°p kh√°c c√≥ v·∫ª d·ªÖ h∆°n l√† ki·∫øm team
member v·ªõi tool set kh√°c nhau.</p>
<p>PS: lib <code>xxtea-py</code> sau khi c√†i <code>sudo apt install -y build-essential python3-dev</code>
v√† <code>pip install cffi xxtea-py</code> tr√™n Ubuntu 20.04, ch·∫°y ƒë∆∞·ª£c ra k·∫øt qu·∫£</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">xxtea</span>

<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;SDZcVdXvZHhKkxopTPYbTvmxTHwFZyyvnutAwsjijXwDqeOg&#39;</span>
<span class="n">secret</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">decodestring</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">xxtea</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}{}{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>
                <span class="k">if</span> <span class="sa">b</span><span class="s2">&quot;SNYK&quot;</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span> <span class="n">exit</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div>

<h2>Linux/system</h2>
<h3>All your flags are belong to root - Linux CLI</h3>
<p>B√†i cho 1 user <code>u</code>, password v√† 1 ƒë·ªãa ch·ªâ ƒë·ªÉ SSH v√†o.
Sau khi login, th·∫•y nh∆∞ sau:</p>
<div class="highlight"><pre><span></span><code>all-your-flags-are-belong-to-root-p4j0:~$
</code></pre></div>

<p>g√µ <code>ls</code> kh√¥ng th·∫•y file g√¨. <code>cd</code> lung tung, t·ªõi <code>/</code>, <code>ls</code> th·∫•y file <code>/flag</code> nh∆∞ng file n√†y ch·ªâ <code>root</code> m·ªõi ƒë·ªçc ƒë∆∞·ª£c.</p>
<p>G√µ th·ª≠ <code>sudo</code> kh√¥ng c√≥, g√µ <code>su -l</code> ƒë·ªÉ
tr·ªü th√†nh root nh·∫≠n ƒë∆∞·ª£c 1 message:</p>
<div class="highlight"><pre><span></span><code>all-your-flags-are-belong-to-root-p4j0:/$ su -l
su: must be suid to work properly

$ ls -la <span class="sb">`</span>which su<span class="sb">`</span>
lrwxrwxrwx    <span class="m">1</span> root     root            <span class="m">12</span> Jun <span class="m">15</span> <span class="m">14</span>:34 /bin/su -&gt; /bin/busybox
</code></pre></div>

<p>File su n√†y kh√° kh√°c th∆∞·ªùng so v·ªõi m√°y b√¨nh th∆∞·ªùng:</p>
<div class="highlight"><pre><span></span><code>~$ ls -la `which su`
-rwsr-xr-x 1 root root 67816 Jul 21  2020 /usr/bin/su
</code></pre></div>

<p>ƒê·ªÉ t·ª´ user th∆∞·ªùng chi·∫øm ƒë∆∞·ª£c quy·ªÅn root ƒë·ªçc file /flag, c·∫ßn "l√†m c√°ch n√†o ƒë√≥", v√† l·ªùi g·ª£i √Ω l√† <strong>suid</strong>.</p>
<p><code>SUID</code> l√† kh√°i ni·ªám √≠t ph·ªï bi·∫øn v·ªõi ng∆∞·ªùi d√πng CLI th√¥ng th∆∞·ªùng, h·ªç h·ªçc h·∫øt chmod 755 777 400 l√† kh√° ƒë·ªß r·ªìi.
<code>SUID</code> l√† m·ªôt gi√° tr·ªã ƒë·∫∑c bi·ªát ƒë·ªÉ c·∫•p quy·ªÅn cho user, khi user ch·∫°y ch∆∞∆°ng tr√¨nh s·∫Ω d√πng UID c·ªßa ng∆∞·ªùi s·ªü h·ªØu file thay v√¨ UID c·ªßa user, hay
n√≥i c√°ch kh√°c, tr·ªü th√†nh ng∆∞·ªùi s·ªü h·ªØu / "chi·∫øm quy·ªÅn" trong l√∫c ch·∫°y ch∆∞∆°ng tr√¨nh n√†y.
Khi chmod, set SUID s·ª≠ d·ª•ng s·ªë <code>4</code> tr∆∞·ªõc s·ªë chmod th√¥ng th∆∞·ªùng. V√≠ d·ª• <code>4755</code>.
L·ªánh <code>su</code> ·ªü tr√™n l√† 1 v√≠ d·ª• c√≥ SUID.
L√Ω do m√¨nh bi·∫øt t·ªõi SUID, do c√¥ng vi·ªác tr∆∞·ªõc ƒë√¢y c√≥ vi·∫øt m·ªôt ch∆∞∆°ng tr√¨nh th·ª±c hi·ªán g·ª≠i ICMP (ping), m√† l·∫°i y√™u c·∫ßu quy·ªÅn root. Trong khi b√¨nh th∆∞·ªùng g√µ l·ªánh ping th√¨ kh√¥ng ph·∫£i sudo/su bao gi·ªù. H√≥a ra <a href="https://security.stackexchange.com/a/222800/11544">l·ªánh ping (ng√†y x∆∞a) set SUID</a> (gi·ªù ko set n·ªØa).</p>
<p>D√πng <code>find</code> t√¨m tr√™n m√°y c√°c file c√≥ set SUID:</p>
<div class="highlight"><pre><span></span><code>$ find / -perm -4000
</code></pre></div>

<p>T√¨m th·∫•y file l·ªánh <code>curl</code>. <code>curl</code> l√† ch∆∞∆°ng tr√¨nh th∆∞·ªùng d√πng ƒë·ªÉ g·ª≠i HTTP request, n√≥ c≈©ng ƒë·ªçc ƒë∆∞·ª£c file khi thay <code>http://</code> b·∫±ng <code>file://</code></p>
<div class="highlight"><pre><span></span><code>all-your-flags-are-belong-to-root-p4j0:/$ curl file:///flag
SNYK{06b0e0ae4995af71335eda2882fecbc5008b01d95990982b439f3f8365fc07f7}
</code></pre></div>

<p>PS: Nh√¨n l·∫°i, n·∫øu hi·ªÉu √Ω c·ªßa ƒë·ªÅ th√¨ ƒë√≥ l√† l·ªùi g·ª£i √Ω file flag n·∫±m ·ªü <code>/</code> (root).</p>
<p>Ref</p>
<ul>
<li><a href="https://security.stackexchange.com/a/222800/11544">https://security.stackexchange.com/a/222800/11544</a></li>
<li><a href="https://www.redhat.com/sysadmin/suid-sgid-sticky-bit">https://www.redhat.com/sysadmin/suid-sgid-sticky-bit</a></li>
<li><a href="https://www.linuxjournal.com/content/gettin-sticky-it">https://www.linuxjournal.com/content/gettin-sticky-it</a></li>
<li><a href="https://www.linuxnix.com/suid-set-suid-linuxunix/">https://www.linuxnix.com/suid-set-suid-linuxunix/</a></li>
</ul>
<h3>Robert Louis Stevenson - docker</h3>
<p>ƒê·ªÅ cho 1 file Docker image ch·ª©a "kho b√°u". T·∫£i file n√†y v·ªÅ,
kh√¥ng nh·ªõ ch√≠nh x√°c l√† t√™n g√¨, t·∫°m g·ªçi l√† <code>file.tar</code>.
B·∫£n ch·∫•t c√°c file "ch∆∞∆°ng tr√¨nh"/"data" tr√™n m√°y t√≠nh th∆∞·ªùng l√† m·ªôt d·∫°ng file archive/n√©n nh∆∞ zip/tar.
Docker image c≈©ng v·∫≠y:</p>
<div class="highlight"><pre><span></span><code># tar xf ../file.tar
# grep -Rin SNYK .
Binary file ./b3b0b5528b213a9d35315784c9907fdeb5d8bf89a0bb012ee63546b3a1c2e10b/layer.tar matches
# tar xf .././b3b0b5528b213a9d35315784c9907fdeb5d8bf89a0bb012ee63546b3a1c2e10b/layer.tar
# grep -Rin SNYK
ak/pp/tv/bc/22/flag:1:SNYK{23acc4111e1905ba1832cab7f1660284e3d1b91d3c2ead7bcec41ee8a4bd5ce9}
</code></pre></div>

<p>Ref:</p>
<ul>
<li><a href="https://www.familug.org/2012/09/nen-giai-nen-bang-command-line-trong.html">https://www.familug.org/2012/09/nen-giai-nen-bang-command-line-trong.html</a></li>
<li><a href="https://github.com/moby/moby/blob/master/image/spec/v1.2.md#combined-image-json--filesystem-changeset-format">https://github.com/moby/moby/blob/master/image/spec/v1.2.md#combined-image-json--filesystem-changeset-format</a></li>
<li><a href="https://github.com/hvnsweeting/pocker">https://github.com/hvnsweeting/pocker</a></li>
<li><a href="grep: https://www.familug.org/2012/10/vai-combo-lenh-de-nho-d-se-uoc-update.html">grep: https://www.familug.org/2012/10/vai-combo-lenh-de-nho-d-se-uoc-update.html</a></li>
</ul>
<p>PS: Robert Louis Stevenson l√† t√°c gi·∫£ c·ªßa truy·ªán "ƒë·∫£o gi·∫•u v√†ng" (Treasure Island)</p>
<h2>Steganography (stego - gi·∫•u tin trong ·∫£nh)</h2>
<h3>qrrr</h3>
<p>via <a href="https://github.com/khanhduy8">khanhduy8</a></p>
<p><img alt="qr" src="http://pp.pymi.vn/images/ctf_qrrr.png"></p>
<p>B√†i cho m·ªôt file ·∫£nh QR ƒë·ªß m√†u s·∫Øc.
L·∫•y zalo ra qu√©t th·ª≠ kh√¥ng ƒë∆∞·ª£c, nh∆∞ v·∫≠y file n√†y th·ª±c ra kh√¥ng ph·∫£i QR ƒë√∫ng chu·∫©n.
Nh√¨n v√†o m√†u s·∫Øc c·ªßa h√¨nh th√¨ c√≥ v·∫ª nh∆∞ QR n√†y g·ªìm 3 m√£ QR t∆∞∆°ng ·ª©ng v·ªõi 3 ƒëo·∫°n m√† khi gh√©p l·∫°i v·ªõi nhau ta c√≥ ƒë∆∞·ª£c flag.
OK. Gi·ªù d√πng m·ªôt c√¥ng c·ª• ƒë∆°n gi·∫£n ƒë·ªÉ x·ª≠ l√Ω file ·∫£nh n√†y. Link Tool: <a href="https://stegonline.georgeom.net/upload">stegonline.georgeom.net</a>
M·ªôt file ·∫£nh m√†u RGB n√†y c√≥ 3 bit planes l√† (Red, Green, Blue).
Th·ª≠ v·ªõi plane Red v·ªõi gi√° tr·ªã l√† 6/8 <a href="https://i.ibb.co/zX5y40c/red.png">ta c√≥</a>,
tr√¥ng c√≥ v·∫ª ·ªïn nh∆∞ng v·ªõi ·∫£nh QR ƒë·ªÉ qu√©t th√¨ ta c·∫ßn reverse l·∫°i m√†u. Sau khi reverse ta ƒë∆∞·ª£c</p>
<p><img alt="reversed" src="http://pp.pymi.vn/images/ctf_qrrr2.png"></p>
<p>Qu√©t m√£ n√†y ra: <code>12d99aa3a92f1abbb7d40786</code>
Do kh√¥ng c√≥ {} n√™n ƒë√¢y ch·∫Øc l√† ƒëo·∫°n gi·ªØa
T∆∞∆°ng t·ª± th·ª≠ v·ªõi Green 6 ƒë∆∞·ª£c: SNYK{6947bd4818ffc1768f2
V·ªõi Green 7: 5ff8d4e4958d8007a3897}
Gh√©p 3 ƒëo·∫°n l·∫°i ra flag: <code>SNYK{6947bd4818ffc1768f212d99aa3a92f1abbb7d407865ff8d4e4958d8007a3897}</code></p>
<p>PS: ng√†y h√¥m sau, khanhduy8 nh·∫≠n ra qrrr l√† l·ªùi g·ª£i √Ω v·ªÅ 3 m√£ qr.</p>
<p>PPS: hvn d√πng Firefox tr√™n Android m·ªü ra ngay ph·∫ßn ƒëu√¥i trong 3 m√£, k·∫øt lu·∫≠n: kh√¥ng d√πng zalo.</p>
<h2>Exploit (khai th√°c l·ªó h·ªïng b·∫£o m·∫≠t)</h2>
<h3>Invisible Ink - javascript</h3>
<p>via <a href="https://github.com/khanhduy8">khanhduy8</a></p>
<p>B√†i n√†y cho 1 link web v√† m·ªôt <a href="http://pp.pymi.vn/ctf/index.js">file source code</a>, 1 file <a href="http://pp.pymi.vn/ctf/package.json">package.json</a>.
C√≥ th·ªÉ ƒë·ªçc source, th·∫•y nghi nghi r·ªìi google th∆∞ vi·ªán <code>lodash</code>, nh∆∞ng pro @hvn
setup <a href="https://docs.snyk.io/">c√¥ng c·ª• c·ªßa Snyk</a>
ƒë·ªÉ qu√©t r·ªìi n√™n ta c√≥ k·∫øt qu·∫£ vulnerbility</p>
<p><img alt="snyk scan" src="http://pp.pymi.vn/images/ctf_snyk_scan.jpeg"></p>
<p>Ch√∫ √Ω ƒë·∫øn vul th·ª© 2. ƒê√¢y l√† PoC c·ªßa exploit vul n√†y <a href="https://snyk.io/vuln/SNYK-JS-LODASH-450202">Prototype Pollution in lodash | Snyk</a>
Trong file source code c√≥ ƒëo·∫°n check:
<code>if(output.flag)</code>
n·∫øu <code>true</code> s·∫Ω response gi√° tr·ªã c·ªßa flag
bi·∫øn output hi·ªán t·∫°i ƒëang l√†:
<code>output = {}</code> n√™n s·∫Ω kh√¥ng tr·∫£ v·ªÅ k·∫øt qu·∫£ ch√∫ng ta c·∫ßn
Trong source code c√≥ s·ª≠ d·ª•ng Unsafe Object recursive merge</p>
<div class="highlight"><pre><span></span><code><span class="k">merge</span><span class="w"> </span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">foreach</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">source</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="ow">exists</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">object</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">source</span><span class="w"></span>
<span class="w">        </span><span class="k">merge</span><span class="p">(</span><span class="n">target</span><span class="o">[</span><span class="n">property</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="n">property</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="n">target</span><span class="o">[</span><span class="n">property</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="o">[</span><span class="n">property</span><span class="o">]</span><span class="w"></span>
</code></pre></div>

<p>trong ƒë√≥ target l√† output c√≤n source l√† request n√™n ch·ªâ c·∫ßn thay request b√¨nh th∆∞·ªùng t·ª´:
<code>{"message": "ping"}</code>
sang
<code>{"constructor": {"prototype": {"flag": true}}}</code>
khi n√†y th√¨ Object ƒë√£ b·ªã th√™m v√†o thu·ªôc t√≠nh <code>flag:true</code>
Do ƒë√≥ <code>output.flag</code> s·∫Ω tr·∫£ v·ªÅ true. Ta c√≥ response ch·ª©a flag:
<code>SNYK{6a6a6fff87f3cfdca056a077804838d4e87f25f6a11e09627062c06f142b10dd}</code></p>
<p><img alt="snyk scan" src="http://pp.pymi.vn/images/ctf_lodash.jpeg"></p>
<h2>K·∫øt qu·∫£</h2>
<p>Team PyMi x·∫øp th·ª© 44 / 537 ƒë·ªôi c√≥ ghi ƒëi·ªÉm, c√≥ l√∫c x·∫øp th·ª© 24. 3h bu·ªìn ng·ªß qu√°
ae lƒÉn quay h·∫øt n√™n t·ª•t h·∫°ng m·∫°nh :))</p>
<p><img alt="44" src="http://pp.pymi.vn/images/ctf_rank.png"></p>
<p>Theo ƒë√°nh gi√° c·ªßa 1 d√¢n ch∆°i th√¨ gi·∫£i CTF n√†y thu·ªôc lo·∫°i trung b√¨nh, ch∆∞a kh√≥,
nh∆∞ng kh√¥ng ph·∫£i game chuy√™n nghi·ªáp do ch·ªâ k√©o d√†i 10 ti·∫øng v√† l·ª£i th·∫ø v·ªÅ
m√∫i gi·ªù cho b√™n ƒë√¥ng M·ªπ (8PM gi·ªù Vi·ªát Nam -&gt; 6AM), c√°c gi·∫£i chuy√™n nghi·ªáp s·∫Ω
k√©o d√†i 24h ƒë·ªÉ ƒë·∫£m b·∫£o c√¥ng b·∫±ng.</p>
<p>ƒêi thi v·ªõi tinh th·∫ßn c·ªç s√°t, c√°c b√†i thi r·∫•t th√∫ v·ªã, h·ªçc ƒë∆∞·ª£c nhi·ªÅu ƒëi·ªÅu m·ªõi
n√™n r·∫•t vui.</p>
<h2>K·∫øt lu·∫≠n</h2>
<p>CTF l√† m·ªôt <strong>tr√≤ ch∆°i</strong> th√∫ v·ªã. Nh∆∞ m·ªçi tr√≤ ch∆°i kh√°c, n√≥ d·ªÖ g√¢y nghi·ªán, v√†
nghi·ªán qu√° l√† kh√¥ng t·ªët. CTF c√≥ lo·∫°i kh√≥, c√≥ lo·∫°i kh√¥ng kh√≥ t·∫πo n√†o, ƒë·ªÉ b·∫Øt ƒë·∫ßu
ch∆°i, h√£y h·ªçc d√πng l·ªánh tr√™n Linux, l·∫≠p tr√¨nh 1 ng√¥n ng·ªØ b·∫•t k·ª≥
v√† tham gia th·ª≠ c√°c game d·ªÖ nh∆∞ tr√™n <a href="https://overthewire.org/wargames/">overthewire.org</a>
hay kh√≥ h∆°n l√† <a href="https://capturetheflag.withgoogle.com/beginners-quest">Google CTF beginners quest</a>
ch∆°i nhi·ªÅu l√† kh√°c quen, v√† l√†m quen v·ªõi chuy·ªán "kh√¥ng ph·∫£i b√†i n√†o m√¨nh c≈©ng gi·∫£i ƒë∆∞·ª£c".</p>
<h2>Updated 2022-02-10 - ph·∫ßn 2 by @pham</h2>
<h4>L·ªùi n√≥i ƒë·∫ßu</h4>
<p>ƒê√¢y l√† m·ªôt gi·∫£i CTF c·ªßa snyk.io - m·ªôt t·ªï ch·ª©c ph√°t tri·ªÉn platform d·∫°ng "Audit source code", nh∆∞ nh·∫≠n ƒë·ªãnh ban ƒë·∫ßu th√¨ c√°c task thi√™n v·ªÅ d·∫°ng programming, misc, v√† m·ªôt s·ªë b√†i l√† l·ªó h·ªïng web m·ª©c ƒë·ªô medium.</p>
<p>Trong gi·∫£i th√¨ m√¨nh kh√° l√† ph·∫ø khi kh√¥ng gi·∫£i ƒë∆∞·ª£c m·∫•y task quan tr·ªçng, m·∫∑c d√π ƒë√£ nh√¨n ra c√°ch gi·∫£i, nh∆∞ng payload kh√¥ng hi·ªÉu sao kh√¥ng work, th·∫≠t l√† bu·ªìn, th√¥i nƒÉm sau ph·ª•c th√π c√πng anh em</p>
<p>Sau cu·ªôc thi th√¨ m√¨nh kh√¥ng vi·∫øt writeup ngay, ƒë·∫øn gi·ªù vi·∫øt l·∫°i th√¨ n·ªôi dung kh√¥ng ƒë∆∞·ª£c tr·ªçn v·∫πn, ae th√¥ng c·∫£m :)</p>
<h4>Task Magician</h4>
<p>ƒê√¢y l√† m·ªôt task old-school v·ªÅ <code>PHP Type Juggling Vulnerabilities</code>
d·∫°ng nh∆∞:</p>
<div class="highlight"><pre><span></span><code><span class="n">var_dump</span><span class="p">(</span><span class="n">md5</span><span class="p">(</span><span class="s1">&#39;240610708&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">md5</span><span class="p">(</span><span class="s1">&#39;QNKCDZO&#39;</span><span class="p">));</span><span class="w"></span>
</code></pre></div>

<p>Do kh√¥ng s·ª≠ d·ª•ng to√°n t·ª≠ <code>===</code> (gi·ªëng nhau v·ªÅ c·∫£ value v√† type) m√† s·ª≠ d·ª•ng <code>==</code>  (ch·ªâ c·∫ßn gi·ªëng nhau v·ªÅ value), ta ho√†n to√†n c√≥ th·ªÉ t√¨m ƒë∆∞·ª£c strings c√≥ md5 th·ªèa m√£n ƒëi·ªÅu ki·ªán b√†i to√°n.</p>
<p>Tham chi·∫øu th√™m t·∫°i:
<a href="https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/">https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/</a></p>
<h4>Task not_hot_dog</h4>
<p>Task cung c·∫•p cho m√¨nh b·ªô ba <code>n,e,c</code> ta c√≥ th·ªÉ bi·∫øt ngay ƒë√¢y l√† m·ªôt b√†i attack RSA, v·ªõi c l√† b·∫£n m√£, sau khi gi·∫£i m√£ ra s·∫Ω thu ƒë∆∞·ª£c FLAG.</p>
<p>Do khi implement RSA h·ªç s·ª≠ d·ª•ng e l·ªõn, n√™n s·∫Ω b·ªã ·∫£nh h∆∞·ªüng b·ªüi  Wiener attack (ƒë√¢y c≈©ng l√† d·∫°ng old-school RSA trong c√°c gi·∫£i CTF)
S·ª≠ d·ª•ng c√¥ng c·ª• t·∫°i: https://github.com/orisano/owiener ƒë·ªÉ thu ƒë∆∞·ª£c flag.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">owiener</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">387825392787200906676631198961098070912332865442137539919413714790310139653713077586557654409565459752133439009280843965856789151962860193830258244424149230046832475959852771134503754778007132465468717789936602755336332984790622132641288576440161244396963980583318569320681953570111708877198371377792396775817</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">609983533322177402468580314139090006939877955334245068261469677806169434040069069770928535701086364941983428090933795745853896746458472620457491993499511798536747668197186857850887990812746855062415626715645223089415186093589721763366994454776521466115355580659841153428179997121984448771910872629371808169183</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">owiener</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="mi">40127490441880177477224469176371044914847896019034308382923938039797354608313</span>
</code></pre></div>

<h4>Task Browser preview</h4>
<p><img alt="done" src="http://pp.pymi.vn/images/browser_preview.png"></p>
<p>V·ªõi t√™n v√† c√°ch setup task n√†y th√¨ c√≥ th·ªÉ th·∫•y ƒë√¢y l√† m·ªôt task v·ªÅ bug SSRF (Server-side request forgery)
SSRF nh∆∞ t√™n g·ªçi th√¨ attacker s·∫Ω khi·∫øn cho server th·ª±c hi·ªán nh·ªØng request t√πy √Ω (t√πy v√†o t·ª´ng tr∆∞·ªùng h·ª£p m√† c√°c protocol s·∫Ω l√† http/dns/ftp/smpt/gopher...) nh∆∞ v·∫≠y khi c√≥ bug SSRF ch√∫ng ta s·∫Ω bypass ƒë∆∞·ª£c c√°c b·ªô filter v·ªÅ source IP  - do request ƒë·∫øn t·ª´ ch√≠nh server (localhost)</p>
<p>Ch·ª©c nƒÉng c·ªßa web l√† nh·∫≠p v√†o m·ªôt URL, ta s·∫Ω preview ƒë∆∞·ª£c n·ªôi dung trang web ƒë√≥.
URL ph·∫£i validate d·∫°ng nh∆∞ sau:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isUrlValid</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Pattern</span><span class="w"> </span><span class="n">domainPattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pattern</span><span class="p">.</span><span class="na">compile</span><span class="p">(</span><span class="s">&quot;^https?://[a-z-0-9]+[.][a-z]+.*$&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Pattern</span><span class="p">.</span><span class="na">CASE_INSENSITIVE</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">Matcher</span><span class="w"> </span><span class="n">matcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">domainPattern</span><span class="p">.</span><span class="na">matcher</span><span class="p">(</span><span class="n">url</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">matcher</span><span class="p">.</span><span class="na">find</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>ƒê·ªçc source th√¨ th·∫•y ti·∫øp  server c√≥ handler ·ªü port 7654, c√≥ th·ªÉ read flag th√¥ng qua ph∆∞∆°ng th·ª©c n√†y.</p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span> <span class="nc">DebugServer</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">HttpServer</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpServer</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">InetSocketAddress</span><span class="p">(</span><span class="mi">7654</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">server</span><span class="p">.</span><span class="na">createContext</span><span class="p">(</span><span class="s">&quot;/flag&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FlagHandler</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="n">server</span><span class="p">.</span><span class="na">setExecutor</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">server</span><span class="p">.</span><span class="na">start</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Nh∆∞ v·∫≠y √Ω ƒë·ªì l√† qu√° r√µ  r√†ng, m√¨nh s·∫Ω nh·∫≠p v√†o m·ªôt URL d·∫°ng localhost:7654/flag ƒë·ªÉ get flag, URL l√†m sao th·ªèa m√£n ƒë∆∞·ª£c b·ªô filter tr√™n l√† OK.
M√¨nh s·ª≠ d·ª•ng URL d·∫°ng: http://domain.localhost:7654/flag
C√≥ th·ªÉ kham kh·∫£o c√°c c√°ch <code>bypass localhost</code> c·ªßa hacktrick
https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery</p>
<h4>Electronbuzz</h4>
<p>grep n·ªôi dung l√† ra ƒë∆∞·ª£c FLAG.</p>
<h4>Instant flag checker</h4>
<p>Task n√†y m√¨nh c≈©ng kh√¥ng c√≤n nh·ªõ r√µ ƒë·ªÅ v√† script h√¥m ƒë√≥ vi·∫øt, ch·∫Øc h√¥m ƒë√≥ gi·∫£i l·∫π qua n√™n vi·∫øt console lu√¥n, kh√¥ng l∆∞u l·∫°i file.</p>
<p>V·ªÅ √Ω t∆∞·ªüng c·ªßa b√†i n√†y l√† d·∫°ng bruteforce ƒë·ªÉ thu ƒë∆∞·ª£c flag, v·∫≠y t·∫°i sao ƒë·ªÉ bruteforce ƒë∆∞·ª£c th√†nh c√¥ng ?</p>
<p>ƒê√≥ l√† s·ª≠ d·ª•ng time-based, c√°c gi√° tr·ªã ƒë√∫ng s·∫Ω c√≥ response time kh√°c v·ªõi v·ªõi c√°c gi√° tr·ªã sai.
Trong nh·ªØng v·∫•n ƒë·ªÅ m√† server kh√¥ng ph·∫£n h·ªìi cho m√¨nh n·ªôi dung response (t·ª©c l√† b·ªã blind) th√¨ vi·ªác √°p d·ª•ng k·ªπ thu·∫≠t time-based (b·∫Øt server th·ª±c hi·ªán c√°c heavy task) ho·∫∑c s·ª≠ d·ª•ng k·ªπ thu·∫≠t outbound (ƒë·∫©y http request hay dns request ra public server kh√°c) th·ª±c s·ª± h·ªØu √Ω.</p>
<h4>T·ªïng k·∫øt</h4>
<p>Ch√¢n th√†nh c·∫£m ∆°n c√°c anh em @b√°c H∆∞ng, @ƒëƒÉng ho√†ng, @Duy H·ªì, @ Khang l√™ h√¥m ƒë√≥ ƒë√£ th·ª©c ƒë√™m l√†m c√πng.
Hy v·ªçng nƒÉm sau ae s·∫Ω ph·ª•c th√¨ d√†nh ƒë∆∞·ª£c rank cao h∆°n (target top 20)</p>
<p>HVN at <a href="http://pymi.vn">http://pymi.vn</a> and <a href="https://www.familug.org">https://www.familug.org</a>.</p>
<ul>
<li><a href="https://www.familug.org/p/ung-ho.html">·ª¶ng h·ªô t√°c gi·∫£ üç∫</a></li>
</ul>
  </div>
  <!-- /.entry-content -->
</section>
<section class="container">
  <div class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'pymier';
      var disqus_identifier = 'article/ctf/';
      var disqus_url = 'http://pp.pymi.vn/article/ctf/';
      (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//pymier.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</section>

    <section class="container footer">
      <footer>
        <address>
        Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
        which takes great advantage of <a href="http://python.org">Python</a>.
        </address>
        <address>
          H·ªçc l·∫≠p tr√¨nh Python t·∫°i <a href="https://pymi.vn/">Pymi.vn</a>
        </address>
      </footer>
    </section>
  </main>

<script type="text/javascript">
var images = document.getElementsByTagName("img");
var i;

for(i = 0; i < images.length; i++) {
  images[i].className += " centered";
}
</script>
</body>

</html>