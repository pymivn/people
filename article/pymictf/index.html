<!DOCTYPE html>
<html lang="vi">

<head>
   <title> KÃ½ sá»± má»™t nÄƒm cÆ°á»›p giáº­t (capture the flag)  - The PyMiers</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="robots" content="" />
  <link rel="stylesheet" type="text/css" href="/theme/css/app.css">
<link rel="stylesheet" type="text/css" href="http://pp.pymi.vn/theme/css/pygment.css">
  <!--
  <link href="https://fonts.googleapis.com/css?family=Fira+Sans" rel="stylesheet">
  -->

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    <meta name="author" content="Pymiers" />
  <meta name="description" content="" />    <link href="http://pp.pymi.vn/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The PyMiers Full Atom Feed" />         
  <meta name="tags" content="ctf" />
  <meta name="tags" content="hacking" />
  <meta name="tags" content="python" />
  <meta name="tags" content="security" />
  <meta name="tags" content="pwn" />
  <meta name="tags" content="rev" />
  <meta name="tags" content="crypto" />
  <meta name="tags" content="web" />
  <meta name="tags" content="misc" />
  <meta name="tags" content="forensics" />
</head>

<body>
  <main class="wrapper">
    <section class="container">
      <header class='column'>
        <h1 class='title'><a href="http://pp.pymi.vn/">The PyMiers</a></h1>
      </header>

      <div class="section">
        <div class="row navbar">
          <div class="column nav-item is-active"><a href="http://pp.pymi.vn/category/trang-chu/">Trang chá»§</a></div>
           <div class="column nav-item "><a href="http://pp.pymi.vn/pages/about/">About</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/add/">Táº¡o bÃ i viáº¿t</a></div>
          <div class="column nav-item "><a href="http://pp.pymi.vn/pages/rss/">RSS</a></div>
          <div class="column nav-item"><a href="/archives">Archives</a></div>
        </div>
      </div>
    </section>

<section class="container">
  <header>
    <h2 class="entry-title">
      <a href="http://pp.pymi.vn/article/pymictf/" rel="bookmark"
         title="Permalink to KÃ½ sá»± má»™t nÄƒm cÆ°á»›p giáº­t (capture the flag)">KÃ½ sá»± má»™t nÄƒm cÆ°á»›p giáº­t (capture the flag)</a></h2>  
  </header>
  <footer class='center'>
    <time class="published" datetime="2022-10-02T00:00:00+07:00"> 02/10/2022 </time>
    <address class="vcard author">By
                    <a class="url fn" href="http://pp.pymi.vn/author/hvnsweeting/">hvnsweeting</a>
 in <a href="http://pp.pymi.vn/category/trang-chu/">Trang chá»§</a>
                </address>     <em>Tags</em>:     <a href="http://pp.pymi.vn/tag/ctf/"><em>ctf</em></a>,     <a href="http://pp.pymi.vn/tag/hacking/"><em>hacking</em></a>,     <a href="http://pp.pymi.vn/tag/python/"><em>python</em></a>,     <a href="http://pp.pymi.vn/tag/security/"><em>security</em></a>,     <a href="http://pp.pymi.vn/tag/pwn/"><em>pwn</em></a>,     <a href="http://pp.pymi.vn/tag/rev/"><em>rev</em></a>,     <a href="http://pp.pymi.vn/tag/crypto/"><em>crypto</em></a>,     <a href="http://pp.pymi.vn/tag/web/"><em>web</em></a>,     <a href="http://pp.pymi.vn/tag/misc/"><em>misc</em></a>,     <a href="http://pp.pymi.vn/tag/forensics/"><em>forensics</em></a>    </footer>
  <br>
  <div class="entry-content">
    <p>ThÃ¡ng 10 nÄƒm 2021, tÃ¬nh cá» tham gia SNYK CTF sau 1 tin quáº£ng cÃ¡o dáº¡o trÃªn email, láº­p team sau vÃ i ngÃ y rá»“i chÃ¡y 24 giá», <a href="http://pp.pymi.vn/article/ctf/">Ä‘á»©ng thá»© 42 báº£ng xáº¿p háº¡ng SNYK.io</a>.</p>
<p>Ká»ƒ tá»« ngÃ y áº¥y, Ä‘á»u Ä‘áº·n má»—i 2 ngÃ y cuá»‘i tuáº§n, <a href="https://ctftime.org/team/175619">team CTF PyMi</a> Ä‘i chiáº¿n 36 giáº£i lá»›n nhá».
Tá»« newbie vá»›i Æ°á»›c mÆ¡ nhá» bÃ© "chá»‰ cáº§n giáº£i Ä‘Æ°á»£c 1 bÃ i", giá» Ä‘Ã£ trá»Ÿ thÃ nh "thi thoáº£ng má»›i giáº£i Ä‘Æ°á»£c 1 bÃ i, cÃ²n toÃ n giáº£i Ä‘Æ°á»£c 2 bÃ i trá»Ÿ lÃªn".</p>
<p>ChÆ¡i CTF xong cÃ³ má»™t cáº£m giÃ¡c thÃ´i: sá»£.
Sá»£ Ä‘áº¿n má»©c pháº£i rÃºt dÃ¢y Ä‘iá»‡n ra Ä‘á»ƒ khÃ´ng cÃ²n bá»‹ hack ná»¯a.
Má»i sá»± an toÃ n Ä‘á»u chá»‰ lÃ  "áº£o tÆ°á»Ÿng", Ä‘áº¿n cáº£ <a href="https://www.imdb.com/title/tt3774114/">chÃ­nh phá»§ cÃ¡c cÆ°á»ng quá»‘c G7 cÃ²n bá»‹
hack</a>, thÃ¬ máº¥y cÃ¡i trang web lÆ°Æ¡ng láº­p trÃ¬nh viÃªn 10 triá»‡u láº¥y Ä‘Ã¢u ra mÃ  cÃ²n.</p>
<p>BÃ i viáº¿t chá»‰ nÃ³i tá»›i pháº§n ká»¹ thuáº­t liÃªn quan Ä‘áº¿n hacking, cÃ²n má»™t pháº§n khÃ¡c Ä‘Ã¡ng
sá»£ khÃ´ng kÃ©m lÃ  "social hacking" lÃ  nguyÃªn nhÃ¢n cá»§a hÃ ng rá»• vá»¥ hack cÃ³ thá»ƒ tham kháº£o <a href="https://www.theverge.com/2022/9/16/23356959/uber-hack-social-engineering-threats">trÃªn in-tÆ¡-nÃ©t</a>.</p>
<p><img alt="Ghost In The Wires" src="https://www.mitnicksecurity.com/hs-fs/hubfs/buy-ghost.png?width=448&amp;name=buy-ghost.png">
<center><a href="https://www.mitnicksecurity.com/ghost-in-the-wires">Ghost In The Wires - cuá»‘n sÃ¡ch vá» 1 hacker social-engineering sá»‘ 1 tháº¿ giá»›i</a></center></p>
<p>CÃ³ má»™t cÃ¢u nÃ³i khÃ¡ khÃ³ nghe nhÆ°ng ná»•i tiáº¿ng:</p>
<blockquote>
<p>"There are two types of companies in the world: those that know they've been hacked and those that don't." - Misha Glenny</p>
</blockquote>
<p>(tá»« Ä‘iá»ƒn dá»‹ch: cÃ³ 2 loáº¡i cÃ´ng ty trÃªn tháº¿ giá»›i: loáº¡i biáº¿t há» Ä‘Ã£ bá»‹ hack, vÃ  loáº¡i khÃ´ng biáº¿t).</p>
<p>DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng bÃ i há»c cho láº­p trÃ¬nh viÃªn lÃ m web (NGHá»€ NGUY HIá»‚M),
vÃ  nhá»¯ng thÃ nh tá»±u, kinh nghiá»‡m thu Ä‘Æ°á»£c tá»« chÆ¡i CTF trong suá»‘t cÃ¡c ngÃ y cuá»‘i tuáº§n cá»§a 1 nÄƒm.</p>
<p>PS: bÃ i viáº¿t dÆ°á»›i gÃ³c Ä‘á»™ má»™t newbie trong ngÃ nh security.</p>
<h3>CÃ¡c bÃ i PHáº¢I há»c cho web developer</h3>
<h4>ÄÃ‚Y LÃ€ NGHá»€ QUÃ NGUY HIá»‚M</h4>
<p>BÆ°á»›c chÃ¢n vÃ o nghá» láº­p trÃ¬nh web tÆ°á»Ÿng chá»‰ cáº§n biáº¿t thiáº¿t káº¿ DB theo 3 normalization form,
dÃ¹ng cÃ¡i DB SQL &amp; NoSQL, dÃ¹ng framework xá»‹n nháº¥t, hiá»ƒu kiáº¿n trÃºc MVC, biáº¿t pull docker vá» build rá»“i báº­t lÃ  Ä‘á»§ (Äƒn).
NhÆ°ng náº¿u trong Ä‘áº§u khÃ´ng Ä‘Æ°á»£c trang bá»‹ Ä‘áº§y Ä‘á»§ kiáº¿n thá»©c vá» security thÃ¬ ngÃ nh lÃ m web nhÆ° má»™t bÃ£i mÃ¬n Ä‘áº§y kinh sá»£.
Cá»¥ thá»ƒ hÆ¡n, náº¿u báº¡n Ä‘ang lÃ m láº­p trÃ¬nh web mÃ  cÃ´ng ty khÃ´ng cÃ³ training, vÃ  báº¡n
cÅ©ng khÃ´ng hiá»ƒu Ä‘áº§y Ä‘á»§ (HIá»‚U khÃ´ng pháº£i CHá»ˆ lÃ  biáº¿t nghÄ©a) nhá»¯ng tá»« Ä‘Ã¡ng sá»£ sau, thÃ¬ kháº£ nÄƒng 96.69 %, cÃ´ng ty báº¡n
thuá»™c loáº¡i 2. MÃ  tháº­m chÃ­ hiá»ƒu Ä‘á»§, cÅ©ng khÃ´ng lÃ m cho báº¡n miá»…n dá»‹ch vá»›i hack.</p>
<p>TrÆ°á»ng lá»›p há»c cÃ³ thá»ƒ dáº¡y lÃ m ra trang web, cháº¡y Ä‘Æ°á»£c, Ä‘Ãºng Ä‘á»§ tÃ­nh nÄƒng,
nhá»¯ng trang cÃ¡ nhÃ¢n nÃ y náº¿u cÃ³ bá»‹ hack, cÅ©ng khÃ´ng cÃ³ háº­u quáº£ lá»›n. NhÆ°ng cÃ´ng ty,
muá»‘n khÃ´ng bá»‹ hack, pháº£i thá»±c hiá»‡n nhiá»‡m vá»¥ training cá»§a mÃ¬nh, khÃ´ng lÃ m tá»± chá»‹u.</p>
<p>CÃ¡c nghá» khÃ¡c cÅ©ng Ä‘á»u cÃ³ nguy cÆ¡ bá»‹ hack dÃ¹ lÃ  DevOps hay sysadmin, nhÆ°ng web lÃ  phá»• biáº¿n nháº¥t.</p>
<h4>Há»c cÃ³ Ä‘á»§ váº«n bá»‹ hack nhÆ° thÆ°á»ng</h4>
<p>Äiá»ƒn hÃ¬nh nhÆ° nÄƒm 2021 lÃª thÃª táº­n sang 2022 váº«n cÃ²n, <a href="https://en.wikipedia.org/wiki/Log4Shell">log4shell</a> lÃ  tá»« khÃ³a Ä‘Ã¡ng sá»£ nháº¥t cho cÃ¡c doanh nghiá»‡p lá»›n, nhá» (Ä‘á»u code báº±ng Java), khi thÆ° viá»‡n log phá»• biáº¿n nháº¥t cá»§a Java "log4j" dÃ­nh lá»—i báº£o máº­t cho phÃ©p hacker cÃ³ thá»ƒ "lÃ m Ä‘á»§ trÃ²".
Lá»—i nÃ y cá»§a ai Ä‘á»ƒ Ä‘i Ä‘á»• lá»—i? dÃ¹ cÃ³ hiá»ƒu Ä‘á»§ cÃ¡c lá»—i báº£o máº­t phá»• biáº¿n
nháº¥t, thÃ¬ má»™t cÃ¡i bug "nhá»" trong thÆ° viá»‡n quÃ¡ phá»• biáº¿n nÃ y cÅ©ng Ä‘á»§ san báº±ng má»™t
cÃ´ng ty. (PS: cÃ¡c hacker thÆ°á»ng khÃ´ng muá»‘n "san báº±ng cÃ´ng ty" trá»« khi quÃ¡ ghÃ©t, mÃ  muá»‘n bÃ­ máº­t náº±m vÃ¹ng trong Ä‘Ã³ rá»“i hÆ°á»Ÿng lá»£i thÃ¬ hÆ¡n).</p>
<h4>CÃ¡c lá»—i báº£o máº­t phá»• biáº¿n nháº¥t: SQLi, XSS, SSTI, CSRF</h4>
<p>Äiá»u Ä‘Ã¡ng sá»£ Ä‘áº§u tiÃªn lÃ  háº§u háº¿t cÃ¡c lá»—i báº£o máº­t nÃ y Ä‘á»u Ä‘Æ°á»£c viáº¿t táº¯t, vá»›i
nhá»¯ng chá»¯ S, nhá»¯ng chá»¯ X, khiáº¿n cho chÆ°a há»c thuá»™c tá»« khÃ³a thÃ¬ nhÃ¬n tÃªn cÅ©ng Ä‘Ã£ sá»£.</p>
<h5>SQLi - SQL injection</h5>
<p>Lá»—i báº£o máº­t phá»• biáº¿n nháº¥t tháº¿ giá»›i tá»« 2005-2018 (sá»‘ liá»‡u chÃ©m giÃ³ mÃ  cháº¯c sáº½ Ä‘Ãºng), nguyÃªn nhÃ¢n
lÃ  do ná»‘i/format string mÃ  khÃ´ng dÃ¹ng ? hay %s Ä‘Ã£ ghi chÃº trong cÃ¡c thÆ° viá»‡n xá»­ lÃ½ SQL.</p>
<p>Never do this -- insecure! (format SQL string)</p>
<div class="highlight"><pre><span></span><code><span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;RHAT&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM stocks WHERE symbol = &#39;</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Do this instead</p>
<div class="highlight"><pre><span></span><code><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;RHAT&#39;</span><span class="p">,)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM stocks WHERE symbol=?&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">())</span>
</code></pre></div>

<p>(trÃ­ch tÃ i liá»‡u <a href="https://docs.python.org/3.10/library/sqlite3.html#sqlite3-placeholders">python sqlite3</a> - <a href="https://www.psycopg.org/docs/usage.html#the-problem-with-the-query-parameters">postgres</a> cÅ©ng cÃ³ tÃ i liá»‡u tÆ°Æ¡ng tá»±, 2022 DB nÃ o cÅ©ng cÃ³ háº¿t).</p>
<p>Lá»— há»•ng nÃ y phá»• biáº¿n tá»›i má»©c cÃ´ng ty báº£o máº­t hÃ ng Ä‘áº§u cÅ©ng dÃ­nh, tÃ¢y cÅ©ng dÃ­nh, tÃ u cÅ©ng dÃ­nh,
Ä‘á»ƒ tháº¥y dÃ¹ Ä‘Ã£ sau hÆ¡n 15 nÄƒm lá»™ng hÃ nh, ngÃ nh giÃ¡o dá»¥c tháº¿ giá»›i váº«n chÆ°a hoÃ n
thÃ nh nhiá»‡m vá»¥. Lá»—i nÃ y khÃ´ng tá»« ai, ká»ƒ cáº£ Ä‘áº¡i há»c, siÃªu há»c báº±ng cáº¥p Ä‘áº§y mÃ¬nh mÃ  ra,
Ä‘á»«ng Ä‘á»• táº¡i há»c, vÃ¬ há»c cÃ³ dáº¡y Ä‘Ã¢u mÃ  biáº¿t.</p>
<h5>SSTI - Server side template injection</h5>
<p>Váº«n lÃ  "injection", tá»©c nhÃ©t thÃªm 1 chÃºt chÃºt vÃ o cÃ¡i pháº§n chÃ­nh há»£p lá»‡.</p>
<p>á» SQLi thÃ¬ inject thÃªm 1 pháº§n cÃ¢u SQL, á»Ÿ "command injection" thÃ¬ thÃªm 1 vÃ i
dáº¥u <code>;rm -rf /</code> Ä‘i kÃ¨m sau Ä‘áº§u vÃ o Ä‘Æ°á»£c yÃªu cáº§u thÃ¬ á»Ÿ SSTI lÃ  thÃªm 1 chÃºt (code)
vÃ o chá»— mÃ  pháº£i nháº­p giÃ¡ trá»‹ bÃ¬nh thÆ°á»ng.</p>
<p>SSTI lÃ  viá»‡c hacker nháº­p vÃ o má»™t Ä‘oáº¡n code, mÃ  khi server thá»±c hiá»‡n
render template (nhÆ° django template, hay Jinja2)
sáº½ cháº¡y Ä‘oáº¡n code nÃ y trÃªn server. Vá» cÆ¡ báº£n khi dÃ¹ng cÃ¡c template engine Ä‘á»u
Ä‘Ã£ xá»­ lÃ½ SSTI báº±ng cÃ¡ch escape cÃ¡c kÃ½ tá»± "báº¥t thÆ°á»ng", nhÆ°ng váº«n khÃ´ng Ã­t khi
cÃ¡c giÃ¡ trá»‹ lá»t vÃ o khÃ´ng qua Ä‘Æ°á»ng template render mÃ  xá»­ lÃ½ ngay nhÆ° string trÃªn python.</p>
<p>VÃ­ dá»¥ vá»›i fstring Ä‘áº§y uy lá»±c theo <a href="https://semgrep.dev/docs/cheat-sheets/flask-xss/">semgrep</a>:</p>
<p>Bug:</p>
<div class="highlight"><pre><span></span><code><span class="n">render_template_string</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;div&gt;</span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/div&gt;&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Fix:</p>
<div class="highlight"><pre><span></span><code><span class="n">render_template_string</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;{{ name }}&lt;/div&gt;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
</code></pre></div>

<h5>XSS - Cross Site Scripting</h5>
<p>XSS thá»±c sá»± khÃ³ hÆ¡n 2 cÃ¡i lá»—i trÃªn Ä‘á»‘i vá»›i láº­p trÃ¬nh viÃªn Python, bá»Ÿi nÃ³ dÃ¹ng JavaScript.
NhÆ°ng á»Ÿ má»©c khÃ³ bÃ¬nh thÆ°á»ng, nÃªn váº«n há»c Ä‘Æ°á»£c. CÆ¡ cháº¿ cÆ¡ báº£n nhÆ° sau:</p>
<ul>
<li>Trang web cho ngÆ°á»i dÃ¹ng nháº­p vÃ o (vÃ­ dá»¥ username, info), vÃ  sau Ä‘Ã³ sáº½ hiá»ƒn thá»‹ giÃ¡ trá»‹ Ä‘Ã³ á»Ÿ 1 trang khÃ¡c</li>
<li>Hacker nháº­p vÃ o Ä‘oáº¡n code javascript, phá»• biáº¿n nháº¥t lÃ  <code>&lt;script&gt;alert(1);&lt;/script&gt;</code></li>
<li>Khi ngÆ°á»i dÃ¹ng khÃ¡c, hay nguy hiá»ƒm hÆ¡n lÃ  admin Ä‘á»c ná»™i dung nÃ y, nÃ³ sáº½ cháº¡y Ä‘oáº¡n code JavaScript hacker Ä‘Æ°a vÃ o
trÃªn mÃ¡y há». Äoáº¡n code JavaScript thÃ¬ cÃ³ thá»ƒ lÃ m Ä‘á»§ trÃ², Ä‘Æ¡n giáº£n nháº¥t lÃ  gá»­i cookie cá»§a ngÆ°á»i dÃ¹ng tá»›i má»™t trang khÃ¡c Ä‘á»ƒ Ä‘Ã¡nh cáº¯p cookie nÃ y. Hacker sau Ä‘Ã³ láº¥y cookie nÃ y Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n ngÆ°á»i dÃ¹ng, chiáº¿m quyá»n.
Nguy hiá»ƒm nháº¥t khi ngÆ°á»i bá»‹ hack lÃ  admin -&gt; xong, háº¿t bÃ i.</li>
</ul>
<p>DÃ¹ng framework cÅ©ng khÃ´ng miá»…n nhiá»…m vá»›i XSS. VÃ­ dá»¥ trang chá»§ cá»§a Flask:</p>
<p>Bug:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/index/&lt;msg&gt;&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
  <span class="k">return</span> <span class="s2">&quot;Hello! &quot;</span> <span class="o">+</span> <span class="n">msg</span>
</code></pre></div>

<p>yes, sorry!!! nhÆ°ng náº¿u trang web lÆ°u giÃ¡ trá»‹ nÃ y láº¡i vÃ  hiá»ƒn thá»‹ á»Ÿ 1 chá»— khÃ¡c,
vÃ  ngÆ°á»i khÃ¡c xem, thÃ¬ nÃ³ Ä‘Ã£ Ä‘á»§ cÆ¡ cháº¿ Ä‘á»ƒ hacker thá»±c hiá»‡n XSS báº±ng cÃ¡ch nháº­p
code JavaScript vÃ o msg.</p>
<p>Fix:</p>
<p>chá»‰ return render_template() hay jsonify(), khÃ´ng return string trá»±c tiáº¿p.</p>
<p><a href="https://docs.djangoproject.com/en/4.1/topics/security/#cross-site-scripting-xss-protection">Django doc</a> cÃ³ vÃ­ dá»¥ khi trong template ghi</p>
<p>Bug:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">style</span> <span class="na">class</span><span class="o">=</span><span class="s">{{</span> <span class="na">var</span> <span class="err">}}</span><span class="p">&gt;</span><span class="o">...</span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</code></pre></div>

<p>Náº¿u hacker Ä‘Æ°a Ä‘Æ°á»£c var vá»›i giÃ¡ trá»‹ lÃ  <code>class1 onmouseover=javascript:func()</code>
thÃ¬ code javascript nÃ y váº«n Ä‘Æ°á»£c cháº¡y.</p>
<p>Fix: pháº£i quote double quote -&gt; <code>"{{ var }}"</code>.</p>
<p>Hay vá»›i link - tham kháº£o thÃªm táº¡i <a href="https://flask.palletsprojects.com/en/2.2.x/security/#cross-site-scripting-xss">doc Flask</a>:</p>
<p>Bug:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ value }}&quot;</span><span class="p">&gt;</span>click here<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>

<p>Hacker nháº­p vÃ o render thÃ nh:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:alert(&#39;unsafe&#39;);&quot;</span><span class="p">&gt;</span>click here<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>

<p>Fix: pháº£i set <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">CSP</a>.</p>
<h5>CSRF - Cross Site Request Forgery</h5>
<p>bÃ i táº­p vá» nhÃ  cho báº¡n Ä‘á»c, tá»± há»c. PS tham kháº£o táº¡i doc <a href="https://docs.djangoproject.com/en/4.1/ref/csrf/">Django</a>.</p>
<h5>JWT - JSON web tokens</h5>
<p><a href="https://pyjwt.readthedocs.io/en/latest/">JWT</a> khÃ´ng pháº£i lá»—i báº£o máº­t, nhÆ°ng hiá»ƒu Ä‘áº§y Ä‘á»§ vá» nÃ³ lÃ  quan trá»ng do viá»‡c sá»­
dá»¥ng phá»• biáº¿n cá»§a cÃ´ng nghá»‡ nÃ y trong authen.</p>
<h5>CÃ²n NHIá»€U ná»¯a</h5>
<p>Xem nhiá»u cÃ¡c lá»—i báº£o máº­t phá»• biáº¿n táº¡i <a href="https://owasp.org/www-project-top-ten/">OWASP</a></p>
<h5>Sysadmin, devops - command injection</h5>
<p>CÃ¡c tool bash/python cá»§a sysadmin thÆ°á»ng dÃ­nh lá»—i "command injection" khi cho phÃ©p ngÆ°á»i dÃ¹ng nháº­p 1 pháº§n cÃ¢u
lá»‡nh vÃ o Ä‘á»ƒ cháº¡y</p>
<p>Bug trÃªn shell script:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="s2">&quot;Hello </span><span class="nv">$1</span><span class="s2">&quot;</span>
</code></pre></div>

<p>Hacker nháº­p vÃ o "hi; echo hello &gt; hacked" lÃ  xong.</p>
<p>Hay dÃ¹ng Python <a href="https://docs.python.org/3.10/library/subprocess.html#security-considerations">subprocess</a>:</p>
<p>Bug:</p>
<div class="highlight"><pre><span></span><code><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;echo hello </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p>Fix:</p>
<div class="highlight"><pre><span></span><code><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;echo hello </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

<p>DÃ¹ng os.system tÆ°Æ¡ng Ä‘Æ°Æ¡ng trÆ°á»ng há»£p bug trÃªn.</p>
<h3>"BÃ³c phá»‘t" nhá»¯ng hiá»ƒu nháº§m vá» CTF</h3>
<h4>Pháº£i ráº¥t "giá»i mÃ¡y tÃ­nh" má»›i chÆ¡i Ä‘Æ°á»£c, pháº£i biáº¿t code</h4>
<p>Giáº£i CTF cÃ³ giáº£i khÃ³ giáº£i dá»…, cÃ³ bÃ i khÃ³ bÃ i dá»…, nhiá»u bÃ i kÃ©o Ä‘á» vÃ o tool lÃ  ra
káº¿t quáº£, chÆ°a ká»‹p dÃ¹ng nÃ£o.
Nghá» hack Ä‘Ã£ cÃ³ tá»« ngÃ y cÃ³ mÃ¡y tÃ­nh, nÃªn viá»‡c hack cÅ©ng cÃ³ sáºµn cáº£ rá»• tool Ä‘á»ƒ dÃ¹ng,
váº­y nÃªn nhiá»u bÃ i khÃ´ng cáº§n pháº£i code.
CÃ³ má»¥c má»›i "OSINT", ká»¹ nÄƒng "tÃ¬m kiáº¿m thÃ´ng tin" cÅ©ng khÃ´ng cáº§n dÃ¹ng tá»›i code,
giá»‘ng nhÆ° giáº£i Ä‘á»‘, tÃ¬m vá»‹ trÃ­, tÃ¬m ai Ä‘Ã³ trÃªn cÃ¡c trang máº¡ng xÃ£ há»™i.
Táº¥t nhiÃªn Ä‘á»ƒ lÃ m Ä‘Æ°á»£c nhiá»u bÃ i khÃ³ hÆ¡n thÃ¬ cáº§n biáº¿t code if/for.</p>
<h4>ChÆ¡i pwn (binary exploitation) hay rev (reverse engineering) pháº£i biáº¿t Ä‘á»c assembly nhÆ° Ä‘á»c tiáº¿ng máº¹ Ä‘áº»</h4>
<p>Tool ráº¥t quan trá»ng, vÃ  cÃ³ nhiá»u tool ráº¥t xá»‹n.
CÃ¡c cáº§u thá»§ Ä‘Ã¡ bÃ³ng Ä‘i toÃ n giÃ y Ä‘inh loáº¡i cá»±c xá»‹n, cÃ¡c runner Ä‘i Nike airflow mÃ u há»“ng phÃ¡ ká»· lá»¥c tháº¿ giá»›i,
cÃ¡c game thá»§ dÃ¹ng bÃ n phÃ­m Ä‘á»™ trá»… siÃªu tháº¥p, chuá»™t cÃ³ dÄƒm ba nÃºt phá»¥ Ä‘á»ƒ combat cho nhanh, cháº£ nghá» nÃ o chÃ¢n tráº§n phi vÃ o quÃ¡i thÃº Ä‘á»ƒ tháº¥t báº¡i rá»“i ra nghÄ©a Ä‘á»‹a cáº£ (trá»Ÿ vá» lÃ  cÃ²n tá»‘t).</p>
<p>CÃ¡c pwn thá»§, rev thá»§ toÃ n dÃ¹ng <a href="https://hex-rays.com/ida-pro/">IDA Pro</a> báº£n tráº£ tiá»n, <a href="https://binary.ninja/">Ninja</a> hÃ ng xá»‹n, báº¥m má»™t nÃºt lÃ  biáº¿n asm thÃ nh code C ngay (ahuhu váº«n pháº£i Ä‘á»c code C), hÃ ng free nhÆ° Ghidra hay radare2 nhiá»u khi khÃ´ng xá»‹n báº±ng, chá»© Ä‘á»«ng nÃ³i tá»›i dump code Assembly rá»“i Ä‘á»c chay.</p>
<h4>ChÆ¡i crypto pháº£i giá»i toÃ¡n</h4>
<p>Giá»i toÃ¡n (mÃ  pháº£i Ä‘Ãºng loáº¡i toÃ¡n) Ä‘Ãºng lÃ  cÃ³ lá»£i, cÃ³ thá»ƒ giáº£i nhiá»u bÃ i khÃ³,
nhÆ°ng crypto cÅ©ng cÃ³ nhiá»u tool sáºµn nhÆ° <a href="https://github.com/RsaCtfTool/RsaCtfTool">RSACTFtool</a>, nhÃ©t Ä‘á» vÃ o viáº¿t thÃªm tÃ­ code lÃ  giáº£i Ä‘Æ°á»£c cáº£ má»›. Nhá»› luyá»‡n háº¿t theo <a href="https://cryptohack.org/challenges/rsa/">CryptoHack</a>, Ä‘á»c cáº£ blog vÃ¬ cÃ³ máº¥y láº§n Ä‘á» KHÃ“ ra trÃºng <a href="https://blog.cryptohack.org/twitter-secrets">bÃ i blog trÃªn cryptohack</a>.</p>
<h4>ToÃ n lÃ  code C, C++, Assembly</h4>
<p>Má»¥c pwn hay rev Ä‘a sá»‘ lÃ  C/C++/asm, nhÆ°ng thi thoáº£ng cÅ©ng cÃ³ Python, Erlang, JavaScript.
CÃ¡c má»¥c khÃ¡c (web/misc) sáº½ chá»©a Ä‘á»§ loáº¡i ngÃ´n ngá»¯ chá»© Ã­t cÃ³ C/C++/Asm.</p>
<h4>top 10 ctftime.org lÃ  giá»i nháº¥t</h4>
<p>Äáº§u tiÃªn lÃ  chuyá»‡n ráº¥t thÃº vá»‹, 6 thÃ¡ng Ä‘áº§u nÄƒm, top 10 lÃ  má»™t bá»™ máº·t khÃ¡c hoÃ n toÃ n vá»›i
thá»i Ä‘iá»ƒm Ä‘áº§u thÃ¡ng 10 nÃ y. Cá»¥c diá»‡n thay Ä‘á»•i hoÃ n toÃ n, nhá»¯ng top 10 vÃ i thÃ¡ng trÆ°á»›c giá»
Ä‘Ã£ tá»¥t xuá»‘ng 20 30.</p>
<p>Thá»© hai, ctftime.org chá»‰ lÃ  pháº§n ná»•i cá»§a táº£ng bÄƒng (ráº¥t chÃ¬m), Ä‘Ã¢u pháº£i hacker nÃ o cÅ©ng ráº£nh mÃ  Ä‘i thi, cÃ²n Ä‘ang báº­n hack cáº£ tháº¿ giá»›i. RiÃªng cÃ³ giáº£i <a href="https://ctftime.org/event/1685">HTB Business</a> má»›i tháº¥y cÃ¡c team security cá»§a cÃ¡c cÃ´ng ty lÃ³ máº·t.</p>
<h4>Python Pickle vÃ´ dá»¥ng</h4>
<p>Má»™t loáº¡i bÃ i gáº§n nhÆ° giáº£i nÃ o cÅ©ng cÃ³, lÃ  lá»—i báº£o máº­t liÃªn quan Ä‘áº¿n pickle. Náº¿u chÆ¡i cho vui thÃ¬ nghe cÅ©ng Ä‘Æ°á»£c,
nhÆ°ng thá»© khÃ´ng báº£o máº­t tháº¿ giá» cÃ²n ai dÃ¹ng? tÃ¬m má»i máº¯t cÃ²n khÃ´ng tháº¥y, Ä‘áº§u tÆ° thá»i gian vÃ o pickle chá»‰ Ä‘á»ƒ chÆ¡i CTF,
khÃ´ng cÃ³ tÃ¡c dá»¥ng trong thá»±c táº¿... cho Ä‘áº¿n khi tháº¥y nÃ³: Bottle - má»™t web framework ráº¥t phá»• biáº¿n cá»§a Python, váº«n
dÃ¹ng pickle khi get cookie, <a href="https://github.com/bottlepy/bottle/issues/900">issue má»Ÿ tá»« 2016, váº«n chÆ°a fix</a>.</p>
<h3>Nhá»¯ng khÃ³ khÄƒn</h3>
<h4>Lá»‹ch chÆ¡i dÃ y Ä‘áº·c</h4>
<p>Báº­n rá»™n Ä‘i lÃ m cáº£ tuáº§n, cuá»‘i tuáº§n 2 ngÃ y nghá»‰ láº¡i chiáº¿n, tuáº§n nÃ o cÅ©ng tháº¿, chÆ°a
ká»‹p ngáº¥m giáº£i nÃ y, há»c cÃ¡c ká»¹ thuáº­t má»›i, thÃ¬ Ä‘Ã£ tá»›i giáº£i khÃ¡c. ChÆ¡i CTF cÃ³ láº½
lÃ  lÃ½ do blog nÃ y cáº£ nÄƒm nay khÃ´ng cÃ³ bÃ i nÃ o, khÃ´ng ai donate khÃ´ng pháº£i lÃ  lÃ½ do =)</p>
<h4>writeup delay</h4>
<p>CÃ¡c bÃ i viáº¿t hÆ°á»›ng dáº«n (gá»i lÃ  writeup) sau giáº£i bá»‹ delay 1 tá»›i vÃ i tuáº§n, do ban tá»• chá»©c thÆ°á»ng
yÃªu cáº§u cÃ¡c top team viáº¿t rá»“i ná»™p Ä‘á»ƒ chá»©ng minh mÃ¬nh khÃ´ng cheat. VÃ  sau vÃ i ba
tuáº§n, thÃ¬ Ä‘ang báº­n chiáº¿n giáº£i khÃ¡c quÃªn máº¥t cáº£ Ä‘á» rá»“i.</p>
<h4>pwn</h4>
<p>KhÃ³.</p>
<p>Pwn thÆ°á»ng hay chá»‰ "binary exploitation", vá»›i ngÆ°á»i code Python hay tháº­m chÃ­ $language
báº¥t ká»³ (trá»« C/Assambly), thÃ¬ Ä‘Ã¢y lÃ  cáº£ má»™t tháº¿ giá»›i hoÃ n toÃ n má»›i, má»›i tá»›i má»©c
Ä‘á»c hÆ°á»›ng dáº«n cho newbie váº«n khÃ´ng hiá»ƒu gÃ¬. Tá»« cáº¥u trÃºc file binary cho tá»›i cÃ¡ch
lÃ m stack overflow.
CÃ³ giáº£i cá»§a SamSung chá»‰ ngá»“i lÃ m tut pwn trong Ä‘á» cho hÆ°á»›ng dáº«n, ráº¥t hay vÃ  chi tiáº¿t.
ThÃ² tay vÃ o lÃ m mÃ  váº«n khÃ³ lÃªn khÃ³ xuá»‘ng vá»›i <a href="https://n.pymi.vn/py3utf8.html">python2 vÃ  3</a>.</p>
<p>Trong CTF kiá»ƒu Jeopady, web vÃ  pwn lÃ  hai má»¥c cÃ³ tÃ­nh "hack" nháº¥t.</p>
<h4>KhÃ³</h4>
<ul>
<li>0CTF</li>
<li>3DCTF</li>
<li>PPP</li>
<li>DEFCON</li>
</ul>
<p>hai giáº£i Ä‘áº§u cá»§a Trung Quá»‘c, cÃ¡c hacker Trung Quá»‘c thÃ¬ khÃ©t tiáº¿ng khá»i nÃ³i rá»“i.
PPP top 1 ctftime.org nhiá»u nÄƒm. DEFCON lá»«ng danh blackhat.</p>
<p>CÃ¡c giáº£i nÃ y chá»‰ vÃ o Ä‘á»c Ä‘á» rá»“i hÃ¬ há»¥c cáº£ 2 ngÃ y váº«n khÃ´ng ra gÃ¬. Sá»£.</p>
<h3>Má»¥c tiÃªu káº¿ tiáº¿p</h3>
<p>Sau nÄƒm Ä‘áº§u, cÃ¡ nhÃ¢n mÃ¬nh chÆ¡i táº¥t cáº£ cÃ¡c thá»ƒ loáº¡i, tá»« misc, forensics qua crypto, tá»›i
rev, sang web, thi thoáº£ng Ä‘á» dá»… lÃ m cáº£ pwn hay cháº¡y autopwn Ä‘á»ƒ tá»± giáº£i.
Sang nÄƒm pháº¥n Ä‘áº¥u theo web vÃ  pwn cho nÃ³ thá»±c chiáº¿n.</p>
<h3>BÃ i há»c rÃºt ra vÃ  hÃ nh Ä‘á»™ng cá»§a chÃºng ta</h3>
<ul>
<li>Biá»ƒn há»c vÃ´ biÃªn, bá»‹ Ä‘iÃªn thÃ¬ há»c. Cá»© ngá»¡ mÃ¬nh Python ngon Äƒn láº¯m, mÃ  nhiá»u bÃ i Pyjail (phÃ¡ ra khá»i chÆ°Æ¡ng trÃ¬nh Python Ä‘Ã£ bá»‹ giá»›i háº¡n cÃ¡c tÃ­nh nÄƒng Ä‘á»ƒ cháº¡y lá»‡nh thoáº£i mÃ¡i - RCE) váº«n khÃ´ng giáº£i Ä‘Æ°á»£c. BÆ°á»›c sang web hay binary thÃ¬
Ã´i thÃ´i cáº£ má»™t chÃ¢n trá»i má»›i. Láº¡i newbie láº¡i tá»« Ä‘áº§u.</li>
<li>Kiá»ƒu <a href="https://n.pymi.vn/byt351.html">byte</a> ngÃ y ngÃ y Ä‘i code, 10 nÄƒm khÃ´ng bao giá» dÃ¹ng thÃ¬ Ä‘i chÆ¡i CTF giáº£i nÃ o cÅ©ng dÃ¹ng.</li>
<li>Khi Ä‘i code, hÃ£y sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ phÃ¡t hiá»‡n lá»—i báº£o máº­t trong code nhÆ° semgrep, bandit, snyk, ...</li>
<li>CÃ¡c cÃ´ng ty hÃ£y cho nghá»‰ lÃ m 1 ngÃ y Ä‘á»ƒ cÃ¡c dev tá»± táº­p hack website cá»§a chÃ­nh mÃ¬nh, training hand-on hack cÃ¡c lá»— há»•ng
báº£o máº­t hay gáº·p nháº¥t, láº­p team CTF chÆ¡i má»¥c web hÃ ng tuáº§n.</li>
<li>Team PyMi chÆ¡i Ã­t giáº£i Ä‘i, mÃ  cháº¥t hÆ¡n.</li>
</ul>
<h3>Báº¯t Ä‘áº§u tá»« Ä‘Ã¢u?</h3>
<p>TÃ i liá»‡u vÃ´ biÃªn, search lÃ  ra cáº£ Ä‘á»‘ng, tham kháº£o:</p>
<ul>
<li><a href="https://n.pymi.vn/byt351.html">python cho hack vá»›i byte</a></li>
<li><a href="http://pp.pymi.vn/article/ctf/">PyMi SNYK 2021 writeup</a></li>
<li><a href="https://github.com/pymivn/ctf">repo cá»§a team CTF PyMi</a></li>
</ul>
<h3>Káº¿t luáº­n</h3>
<p>CÃ¡m Æ¡n cÃ¡c anh em team CTF PyMi Ä‘Ã£ cÃ¹ng chiáº¿n Ä‘áº¥u suá»‘t 1 nÄƒm trá»i, nhiá»u anh em
váº«n cÃ²n chÆ°a biáº¿t máº·t. Hy vá»ng nÄƒm thá»© 2 sáº½ gáº·p nhau Ä‘Æ°á»£c Ã­t nháº¥t 1 láº§n, khÃ´ng thÃ¬ cÅ©ng
2 láº§n trá»Ÿ lÃªn.</p>
<p>To another CTFking year.</p>
<p>Háº¿t.</p>
<p>HVN at <a href="http://pymi.vn">http://pymi.vn</a> and <a href="https://www.familug.org">https://www.familug.org</a>.</p>
<ul>
<li><a href="https://www.familug.org/p/ung-ho.html">á»¦ng há»™ tÃ¡c giáº£ ğŸº</a></li>
</ul>
  </div>
  <!-- /.entry-content -->
</section>
<section class="container">
  <div class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'pymier';
      var disqus_identifier = 'article/pymictf/';
      var disqus_url = 'http://pp.pymi.vn/article/pymictf/';
      (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//pymier.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</section>

    <section class="container footer">
      <footer>
        <address>
        Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
        which takes great advantage of <a href="http://python.org">Python</a>.
        </address>
        <address>
          Há»c láº­p trÃ¬nh Python táº¡i <a href="https://pymi.vn/">Pymi.vn</a>
        </address>
      </footer>
    </section>
  </main>

<script type="text/javascript">
var images = document.getElementsByTagName("img");
var i;

for(i = 0; i < images.length; i++) {
  images[i].className += " centered";
}
</script>
</body>

</html>